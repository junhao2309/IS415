<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-03-06">

<title>IS415-GAA - Take-home Exercise 3: Predicting HDB Public Housing Resale Pricies using Geographically Weighted Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex10/Hands-on_Ex10.html">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html">
 <span class="dropdown-text">In-class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex11/In-class_Ex11.html">
 <span class="dropdown-text">In-class Exercise 11</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex01/Take-Home_Ex01.html">
 <span class="dropdown-text">Take-Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex02/Take-Home_Ex02.html">
 <span class="dropdown-text">Take-Home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-Home_Ex/Take-Home_Ex03/Take-Home_Ex03.html">
 <span class="dropdown-text">Take-Home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/junhao2309/IS415"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About Me</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setting-the-scene" id="toc-setting-the-scene" class="nav-link active" data-scroll-target="#setting-the-scene"><span class="toc-section-number">1</span>  Setting the Scene</a>
  <ul class="collapse">
  <li><a href="#the-task" id="toc-the-task" class="nav-link" data-scroll-target="#the-task"><span class="toc-section-number">1.1</span>  The Task</a></li>
  <li><a href="#packages-used" id="toc-packages-used" class="nav-link" data-scroll-target="#packages-used"><span class="toc-section-number">1.2</span>  Packages used:</a></li>
  <li><a href="#data-used" id="toc-data-used" class="nav-link" data-scroll-target="#data-used"><span class="toc-section-number">1.3</span>  Data used:</a>
  <ul class="collapse">
  <li><a href="#how-to-extract-data-from-onemap" id="toc-how-to-extract-data-from-onemap" class="nav-link" data-scroll-target="#how-to-extract-data-from-onemap"><span class="toc-section-number">1.3.1</span>  How to extract data from onemap</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#load-data-into-r" id="toc-load-data-into-r" class="nav-link" data-scroll-target="#load-data-into-r"><span class="toc-section-number">2</span>  Load Data into R</a>
  <ul class="collapse">
  <li><a href="#geospatial-data" id="toc-geospatial-data" class="nav-link" data-scroll-target="#geospatial-data"><span class="toc-section-number">2.1</span>  Geospatial Data</a></li>
  </ul></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling"><span class="toc-section-number">3</span>  Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#hdb-resale-price" id="toc-hdb-resale-price" class="nav-link" data-scroll-target="#hdb-resale-price"><span class="toc-section-number">3.1</span>  HDB Resale Price</a>
  <ul class="collapse">
  <li><a href="#story-and-date-adjustents" id="toc-story-and-date-adjustents" class="nav-link" data-scroll-target="#story-and-date-adjustents"><span class="toc-section-number">3.1.1</span>  Story and Date adjustents</a></li>
  <li><a href="#date" id="toc-date" class="nav-link" data-scroll-target="#date"><span class="toc-section-number">3.1.2</span>  Date</a></li>
  <li><a href="#flat-model" id="toc-flat-model" class="nav-link" data-scroll-target="#flat-model"><span class="toc-section-number">3.1.3</span>  Flat Model</a></li>
  <li><a href="#remaining-lease" id="toc-remaining-lease" class="nav-link" data-scroll-target="#remaining-lease"><span class="toc-section-number">3.1.4</span>  Remaining Lease</a></li>
  <li><a href="#inserting-geometries" id="toc-inserting-geometries" class="nav-link" data-scroll-target="#inserting-geometries"><span class="toc-section-number">3.1.5</span>  Inserting geometries</a></li>
  <li><a href="#convert-into-resale_2023-dataframe-into-sf" id="toc-convert-into-resale_2023-dataframe-into-sf" class="nav-link" data-scroll-target="#convert-into-resale_2023-dataframe-into-sf"><span class="toc-section-number">3.1.6</span>  Convert into Resale_2023 dataframe into sf</a></li>
  </ul></li>
  <li><a href="#aspatial-data-wrangling" id="toc-aspatial-data-wrangling" class="nav-link" data-scroll-target="#aspatial-data-wrangling"><span class="toc-section-number">3.2</span>  Aspatial Data Wrangling</a></li>
  <li><a href="#ensure-all-datasets-are-in-epsg3414" id="toc-ensure-all-datasets-are-in-epsg3414" class="nav-link" data-scroll-target="#ensure-all-datasets-are-in-epsg3414"><span class="toc-section-number">3.3</span>  Ensure all datasets are in EPSG:3414</a></li>
  <li><a href="#checking-invalid-geometries" id="toc-checking-invalid-geometries" class="nav-link" data-scroll-target="#checking-invalid-geometries"><span class="toc-section-number">3.4</span>  Checking invalid geometries</a></li>
  <li><a href="#removing-unnecessary-columns" id="toc-removing-unnecessary-columns" class="nav-link" data-scroll-target="#removing-unnecessary-columns"><span class="toc-section-number">3.5</span>  Removing Unnecessary columns</a></li>
  <li><a href="#check-na-values" id="toc-check-na-values" class="nav-link" data-scroll-target="#check-na-values"><span class="toc-section-number">3.6</span>  Check NA values</a></li>
  </ul></li>
  <li><a href="#visualisation" id="toc-visualisation" class="nav-link" data-scroll-target="#visualisation"><span class="toc-section-number">4</span>  Visualisation</a></li>
  <li><a href="#proximity-distance-calculator" id="toc-proximity-distance-calculator" class="nav-link" data-scroll-target="#proximity-distance-calculator"><span class="toc-section-number">5</span>  Proximity distance calculator</a>
  <ul class="collapse">
  <li><a href="#facility-count-within-radius-calculation" id="toc-facility-count-within-radius-calculation" class="nav-link" data-scroll-target="#facility-count-within-radius-calculation"><span class="toc-section-number">5.1</span>  Facility Count within Radius Calculation</a></li>
  </ul></li>
  <li><a href="#read-data-in" id="toc-read-data-in" class="nav-link" data-scroll-target="#read-data-in"><span class="toc-section-number">6</span>  Read Data in</a></li>
  <li><a href="#computing-correlation-matrix" id="toc-computing-correlation-matrix" class="nav-link" data-scroll-target="#computing-correlation-matrix"><span class="toc-section-number">7</span>  Computing Correlation Matrix</a></li>
  <li><a href="#building-a-non-spatial-multiple-linear-regression" id="toc-building-a-non-spatial-multiple-linear-regression" class="nav-link" data-scroll-target="#building-a-non-spatial-multiple-linear-regression"><span class="toc-section-number">8</span>  Building a non-spatial multiple linear regression</a>
  <ul class="collapse">
  <li><a href="#understanding-the-non-spatial-multiple-linear-regression-model" id="toc-understanding-the-non-spatial-multiple-linear-regression-model" class="nav-link" data-scroll-target="#understanding-the-non-spatial-multiple-linear-regression-model"><span class="toc-section-number">8.1</span>  Understanding the non-spatial multiple linear regression model</a></li>
  <li><a href="#calculating-predictive-error" id="toc-calculating-predictive-error" class="nav-link" data-scroll-target="#calculating-predictive-error"><span class="toc-section-number">8.2</span>  Calculating predictive error</a></li>
  </ul></li>
  <li><a href="#gwr-predictive-method" id="toc-gwr-predictive-method" class="nav-link" data-scroll-target="#gwr-predictive-method"><span class="toc-section-number">9</span>  GWR Predictive Method</a>
  <ul class="collapse">
  <li><a href="#converting-sf-dataframe-to-spatialpointdataframe" id="toc-converting-sf-dataframe-to-spatialpointdataframe" class="nav-link" data-scroll-target="#converting-sf-dataframe-to-spatialpointdataframe"><span class="toc-section-number">9.1</span>  Converting sf dataframe to SpatialPointDataframe</a></li>
  <li><a href="#finding-optimal-adaptive-bandwidth" id="toc-finding-optimal-adaptive-bandwidth" class="nav-link" data-scroll-target="#finding-optimal-adaptive-bandwidth"><span class="toc-section-number">9.2</span>  Finding optimal adaptive bandwidth</a></li>
  <li><a href="#constructing-the-adaptive-bandwidth-gwr" id="toc-constructing-the-adaptive-bandwidth-gwr" class="nav-link" data-scroll-target="#constructing-the-adaptive-bandwidth-gwr"><span class="toc-section-number">9.3</span>  Constructing the adaptive bandwidth GWR</a></li>
  <li><a href="#preparing-coordinates-data" id="toc-preparing-coordinates-data" class="nav-link" data-scroll-target="#preparing-coordinates-data"><span class="toc-section-number">9.4</span>  Preparing coordinates data</a>
  <ul class="collapse">
  <li><a href="#extracting-coordinates-data" id="toc-extracting-coordinates-data" class="nav-link" data-scroll-target="#extracting-coordinates-data"><span class="toc-section-number">9.4.1</span>  Extracting coordinates data</a></li>
  <li><a href="#dropping-geometry-field" id="toc-dropping-geometry-field" class="nav-link" data-scroll-target="#dropping-geometry-field"><span class="toc-section-number">9.4.2</span>  Dropping geometry field</a></li>
  </ul></li>
  <li><a href="#calibrating-random-forest-model" id="toc-calibrating-random-forest-model" class="nav-link" data-scroll-target="#calibrating-random-forest-model"><span class="toc-section-number">9.5</span>  Calibrating Random Forest Model</a></li>
  <li><a href="#calibrating-geographical-random-forest-model" id="toc-calibrating-geographical-random-forest-model" class="nav-link" data-scroll-target="#calibrating-geographical-random-forest-model"><span class="toc-section-number">9.6</span>  Calibrating Geographical Random Forest Model</a></li>
  <li><a href="#predicting-by-using-test-data" id="toc-predicting-by-using-test-data" class="nav-link" data-scroll-target="#predicting-by-using-test-data"><span class="toc-section-number">9.7</span>  Predicting by using test data</a>
  <ul class="collapse">
  <li><a href="#preparing-the-test-data" id="toc-preparing-the-test-data" class="nav-link" data-scroll-target="#preparing-the-test-data"><span class="toc-section-number">9.7.1</span>  Preparing the test data</a></li>
  <li><a href="#predicting-with-test-data" id="toc-predicting-with-test-data" class="nav-link" data-scroll-target="#predicting-with-test-data"><span class="toc-section-number">9.7.2</span>  Predicting with test data</a></li>
  <li><a href="#converting-predicted-output-into-a-data-frame" id="toc-converting-predicted-output-into-a-data-frame" class="nav-link" data-scroll-target="#converting-predicted-output-into-a-data-frame"><span class="toc-section-number">9.7.3</span>  Converting predicted output into a data frame</a></li>
  <li><a href="#calculating-root-mean-square-error" id="toc-calculating-root-mean-square-error" class="nav-link" data-scroll-target="#calculating-root-mean-square-error"><span class="toc-section-number">9.7.4</span>  Calculating Root Mean Square Error</a></li>
  <li><a href="#visualising-the-predicted-values" id="toc-visualising-the-predicted-values" class="nav-link" data-scroll-target="#visualising-the-predicted-values"><span class="toc-section-number">9.7.5</span>  Visualising the predicted values</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="toc-section-number">10</span>  Conclusion</a>
  <ul class="collapse">
  <li><a href="#differences-between-the-two-models" id="toc-differences-between-the-two-models" class="nav-link" data-scroll-target="#differences-between-the-two-models"><span class="toc-section-number">10.1</span>  Differences between the two models</a></li>
  <li><a href="#predictive-power" id="toc-predictive-power" class="nav-link" data-scroll-target="#predictive-power"><span class="toc-section-number">10.2</span>  Predictive Power</a></li>
  <li><a href="#limitations-of-analysis" id="toc-limitations-of-analysis" class="nav-link" data-scroll-target="#limitations-of-analysis"><span class="toc-section-number">10.3</span>  Limitations of Analysis</a></li>
  <li><a href="#possible-improvements-to-the-model" id="toc-possible-improvements-to-the-model" class="nav-link" data-scroll-target="#possible-improvements-to-the-model"><span class="toc-section-number">10.4</span>  Possible Improvements to the model</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="toc-section-number">11</span>  References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 3: Predicting HDB Public Housing Resale Pricies using Geographically Weighted Methods</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 6, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 27, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="setting-the-scene" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Setting the Scene</h1>
<p>Housing is an essential component of household wealth worldwide. Buying a housing has always been a major investment for most people. The price of housing is affected by many factors. Some of them are global in nature such as the general economy of a country or inflation rate. Others can be more specific to the properties themselves. These factors can be further divided to structural and locational factors. Structural factors are variables related to the property themselves such as the size, fitting, and tenure of the property. Locational factors are variables related to the neighbourhood of the properties such as proximity to childcare centre, public transport service and shopping centre.</p>
<p>Conventional, housing resale prices predictive models were built by using <a href="https://en.wikipedia.org/wiki/Ordinary_least_squares"><strong>Ordinary Least Square (OLS)</strong></a> method. However, this method failed to take into consideration that spatial autocorrelation and spatial heterogeneity exist in geographic data sets such as housing transactions. With the existence of spatial autocorrelation, the OLS estimation of predictive housing resale pricing models could lead to biased, inconsistent, or inefficient results (Anselin 1998). In view of this limitation, <strong>Geographical Weighted Models</strong> were introduced for calibrating predictive model for housing resale prices.</p>
<section id="the-task" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="the-task"><span class="header-section-number">1.1</span> The Task</h2>
<p>In this take-home exercise, I am tasked to predict HDB resale prices at the sub-market level (HDB 5-room) for the month of January and February 2023 in Singapore. The predictive models must be built by using by using conventional OLS method and GWR methods. The data set used to train the model is from January 2021 to December 2022.</p>
</section>
<section id="packages-used" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="packages-used"><span class="header-section-number">1.2</span> Packages used:</h2>
<p><strong>The R packages we’ll use for this analysis are:</strong></p>
<ul>
<li><p><a href="https://cran.r-project.org/web/packages/sf/index.html"><strong>sf</strong></a>: used for importing, managing, and processing geospatial data</p></li>
<li><p><a href="https://www.tidyverse.org/"><strong>tidyverse</strong></a>: a collection of packages for data science tasks</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/tmap/index.html"><strong>tmap</strong></a>: used for creating thematic maps, such as choropleth and bubble maps</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/spdep/index.html"><strong>spdep</strong></a>: used to create spatial weights matrix objects, global and local spatial autocorrelation statistics and related calculations (e.g.&nbsp;spatially lag attributes)</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/onemapsgapi/index.html"><strong>onemapsgapi</strong></a>: used to query Singapore-specific spatial data, alongside additional functionalities. Recommended readings: <a href="https://cran.r-project.org/web/packages/onemapsgapi/vignettes/onemapsgapi_vignette.html">Vignette</a> and <a href="https://www.onemap.gov.sg/docs/">Documentation</a></p></li>
<li><p><a href="https://cran.r-project.org/web/packages/httr/"><strong>httr</strong></a> <strong>: used to make API calls, such as a GET request</strong></p></li>
<li><p><a href="https://cran.r-project.org/web/packages/units/index.html"><strong>units</strong></a>: used to for manipulating numeric vectors that have physical measurement units associated with them</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/matrixStats/index.html"><strong>matrixStats</strong></a>: a set of high-performing functions for operating on rows and columns of matrices</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/jsonlite/vignettes/json-aaquickstart.html"><strong>jsonlite</strong></a>: a JSON parser that can convert from JSON to the appropriate R data types</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/corrplot/vignettes/corrplot-intro.html"><strong>corrplot</strong></a> + <a href="https://cran.r-project.org/web/packages/ggpubr/index.html"><strong>ggpubr</strong></a>: both are used for multivariate data visualisation &amp; analysis</p></li>
<li><p><a href="https://cran.r-project.org/web/packages/GWmodel/index.html"><strong>GWmodel</strong></a>: provides a collection of localised spatial statistical methods, such as summary statistics, principal components analysis, discriminant analysis and various forms of GW regression</p></li>
<li><p><a href="https://haozhu233.github.io/kableExtra/"><strong>kableExtra</strong></a>: an extension of kable, used for table customisation</p></li>
</ul>
<p><strong>The following tidyverse packages will be used:</strong></p>
<ul>
<li><p><strong>readr</strong> for importing delimited files (.csv)</p></li>
<li><p><strong>tidyr</strong> for manipulating and tidying data</p></li>
<li><p><strong>dplyr</strong> for wrangling and transforming data</p></li>
<li><p><strong>ggplot2</strong> for visualising data</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, sf, sfdep, tmap, httr, jsonlite, matrixStats, readr, GWmodel, SpatialML, rsample, Metrics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-used" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="data-used"><span class="header-section-number">1.3</span> Data used:</h2>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># initialise a dataframe of our aspatial and geospatial dataset details</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>datasets <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Type=</span><span class="fu">c</span>(<span class="st">"Aspatial"</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial"</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial"</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Onemap"</span>,</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Onemap"</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Onemap"</span>,</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Onemap"</span>,</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Onemap"</span>,</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Onemap"</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Onemap"</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Onemap"</span>,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Geospatial - Onemap"</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Aspatial - Self-Sourced"</span>,</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Aspatial - Self-Sourced"</span>),</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Name=</span><span class="fu">c</span>(<span class="st">"Resale Flat Prices"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Master Plan 2019 Subzone Boundary (Web)"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">"MRT &amp; LRT Exit Locations"</span>,</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Bus Stop Locations"</span>,</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Childcare Services"</span>,</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Eldercare Services"</span>,</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Hawker Centres"</span>,</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Kindergartens"</span>,</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Parks"</span>,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Supermarkets"</span>,</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Community Clubs"</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Family Services"</span>,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Registered Pharmacies"</span>,</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>         </span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Schools"</span>,</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>         <span class="st">"Shopping Mall SVY21 Coordinates`"</span>),</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">Format=</span><span class="fu">c</span>(<span class="st">".csv"</span>, </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>, </span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>           <span class="st">".shp"</span>,</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>           <span class="st">".csv"</span>,</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>           <span class="st">".csv"</span>),</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">Source=</span><span class="fu">c</span>(<span class="st">"[data.gov.sg](https://data.gov.sg/dataset/resale-flat-prices)"</span>,</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>           <span class="st">"data.gov.sg"</span>,</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[LTA Data Mall](https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=Train)"</span>,</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[LTA Data Mall](https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=bus%20stop)"</span>,</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API]"</span>,</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[OneMap API](https://www.onemap.gov.sg/docs/)"</span>,</span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[data.gov.sg](https://data.gov.sg/dataset/school-directory-and-information)"</span>,</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>           <span class="st">"[Mall SVY21 Coordinates Web Scaper](https://github.com/ValaryLim/Mall-Coordinates-Web-Scraper)"</span>)</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a><span class="co"># with reference to this guide on kableExtra:</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a><span class="co"># https://cran.r-project.org/web/packages/kableExtra/vignettes/awesome_table_in_html.html</span></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a><span class="co"># kable_material is the name of the kable theme</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a><span class="co"># 'hover' for to highlight row when hovering, 'scale_down' to adjust table to fit page width</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(datasets, <span class="at">caption=</span><span class="st">"Datasets Used"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_material</span>(<span class="st">"hover"</span>, <span class="at">latex_options=</span><span class="st">"scale_down"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class=" lightable-material lightable-hover" style="font-family: &quot;Source Sans Pro&quot;, helvetica, sans-serif; margin-left: auto; margin-right: auto;">
<caption>Datasets Used</caption>
 <thead>
  <tr>
   <th style="text-align:left;"> Type </th>
   <th style="text-align:left;"> Name </th>
   <th style="text-align:left;"> Format </th>
   <th style="text-align:left;"> Source </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> Aspatial </td>
   <td style="text-align:left;"> Resale Flat Prices </td>
   <td style="text-align:left;"> .csv </td>
   <td style="text-align:left;"> [data.gov.sg](https://data.gov.sg/dataset/resale-flat-prices) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial </td>
   <td style="text-align:left;"> Master Plan 2019 Subzone Boundary (Web) </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> data.gov.sg </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial </td>
   <td style="text-align:left;"> MRT &amp; LRT Exit Locations </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [LTA Data Mall](https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=Train) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial </td>
   <td style="text-align:left;"> Bus Stop Locations </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [LTA Data Mall](https://datamall.lta.gov.sg/content/datamall/en/search_datasets.html?searchText=bus%20stop) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Onemap </td>
   <td style="text-align:left;"> Childcare Services </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API] </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Onemap </td>
   <td style="text-align:left;"> Eldercare Services </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Onemap </td>
   <td style="text-align:left;"> Hawker Centres </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Onemap </td>
   <td style="text-align:left;"> Kindergartens </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Onemap </td>
   <td style="text-align:left;"> Parks </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Onemap </td>
   <td style="text-align:left;"> Supermarkets </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Onemap </td>
   <td style="text-align:left;"> Community Clubs </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Onemap </td>
   <td style="text-align:left;"> Family Services </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Geospatial - Onemap </td>
   <td style="text-align:left;"> Registered Pharmacies </td>
   <td style="text-align:left;"> .shp </td>
   <td style="text-align:left;"> [OneMap API](https://www.onemap.gov.sg/docs/) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Aspatial - Self-Sourced </td>
   <td style="text-align:left;"> Schools </td>
   <td style="text-align:left;"> .csv </td>
   <td style="text-align:left;"> [data.gov.sg](https://data.gov.sg/dataset/school-directory-and-information) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Aspatial - Self-Sourced </td>
   <td style="text-align:left;"> Shopping Mall SVY21 Coordinates` </td>
   <td style="text-align:left;"> .csv </td>
   <td style="text-align:left;"> [Mall SVY21 Coordinates Web Scaper](https://github.com/ValaryLim/Mall-Coordinates-Web-Scraper) </td>
  </tr>
</tbody>
</table>

</div>
</div>
<section id="how-to-extract-data-from-onemap" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="how-to-extract-data-from-onemap"><span class="header-section-number">1.3.1</span> How to extract data from onemap</h3>
<p>These are the steps:</p>
<p><em>The code chunks below uses onemapsgapi package.</em></p>
<ol type="1">
<li>Register an account with <a href="https://developers.onemap.sg/register/">onemap</a></li>
<li>A code is then be sent to your email. Then fill in this <a href="https://developers.onemap.sg/confirm_account/">form</a></li>
<li>In the console, run the code chunk below:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>token <span class="ot">&lt;-</span> <span class="fu">get_token</span>(<span class="st">"email"</span>, <span class="st">"password"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Input the email and password that you’ve registered with onemap. This will provide you a token ID under objectname: token. Note that you will need to do this again as the token is only valid for 3 days.</p>
<ol start="4" type="1">
<li>Obtain queryname by running the code chunk below:</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>themes <span class="ot">&lt;-</span> <span class="fu">search_themes</span>(token)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Input your token ID and you can source for the queryname for Step 5.</p>
<ol start="5" type="1">
<li>Use get_theme() to get the data from onemap</li>
</ol>
<p>For this example, we will use queryname, “eldercare”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>eldercare<span class="ot">&lt;-</span><span class="fu">get_theme</span>(token,<span class="st">"eldercare"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="6" type="1">
<li>Convert the object into an sf object then download it into your data folder. st_as_sf() is for converting the file and st_write() is for writing the file into your folder. st_transform() sets the coordinate reference system to Singapore, EPSG::3414. These functions are from the sf package.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>eldercaresf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(eldercare, <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                        <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> eldercaresf,</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"eldercare"</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>To make it more automatic, define which variables you want from the onemap database into a vector. The code chunk runs a for loop that does steps 5 and 6 together and stores them into your folder.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>onemap_variables <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"childcare"</span>, <span class="st">"communityclubs"</span>, <span class="st">"eldercare"</span>, <span class="st">"family"</span>, <span class="st">"hawkercentre"</span>, <span class="st">"kindergartens"</span>, <span class="st">"nationalparks"</span>,<span class="st">"registered_pharmacy"</span>,<span class="st">"supermarkets"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>df_sf <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(onemap_variables)){</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  df[[i]] <span class="ot">&lt;-</span> <span class="fu">get_theme</span>(token, onemap_variables[i])</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  df_sf[[i]] <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(df[[i]], <span class="at">coords=</span><span class="fu">c</span>(<span class="st">"Lng"</span>, <span class="st">"Lat"</span>), </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(<span class="at">obj =</span> df_sf[[i]],</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/geospatial/Onemap"</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> onemap_variables[i],</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
</section>
<section id="load-data-into-r" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Load Data into R</h1>
<section id="geospatial-data" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="geospatial-data"><span class="header-section-number">2.1</span> Geospatial Data</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">One-Map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Geospatial Map</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">DATA.GOV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Aspatial Data</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>We will make use of st_read() from the sf package to load the data in</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pharmacy <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/Onemap"</span>,</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"registered_pharmacy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `registered_pharmacy' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/geospatial/Onemap' 
  using driver `ESRI Shapefile'
Simple feature collection with 269 features and 8 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 13049.46 ymin: 26540.77 xmax: 46829.34 ymax: 47763.05
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>parks <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/Onemap"</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">layer =</span> <span class="st">"nationalparks"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `nationalparks' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/geospatial/Onemap' 
  using driver `ESRI Shapefile'
Simple feature collection with 421 features and 2 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 12374.75 ymin: 21917.81 xmax: 52533.09 ymax: 49296.46
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>kindergartens <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/Onemap"</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">layer =</span> <span class="st">"kindergartens"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `kindergartens' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/geospatial/Onemap' 
  using driver `ESRI Shapefile'
Simple feature collection with 448 features and 5 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 11909.7 ymin: 25596.33 xmax: 43395.47 ymax: 48562.06
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>hawker <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/Onemap"</span>,</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">layer =</span> <span class="st">"hawkercentre"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `hawkercentre' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/geospatial/Onemap' 
  using driver `ESRI Shapefile'
Simple feature collection with 125 features and 18 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 12874.19 ymin: 28355.97 xmax: 45241.4 ymax: 47850.43
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>eldercare <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/Onemap"</span>,</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">layer =</span> <span class="st">"eldercare"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `eldercare' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/geospatial/Onemap' 
  using driver `ESRI Shapefile'
Simple feature collection with 133 features and 4 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>communityclubs <span class="ot">&lt;-</span><span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/Onemap"</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">layer =</span> <span class="st">"communityclubs"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `communityclubs' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/geospatial/Onemap' 
  using driver `ESRI Shapefile'
Simple feature collection with 125 features and 11 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 12308.4 ymin: 28593.37 xmax: 42008.87 ymax: 48958.52
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>supermarkets <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/Onemap"</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">layer =</span> <span class="st">"SUPERMARKETS"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `SUPERMARKETS' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/geospatial/Onemap' 
  using driver `ESRI Shapefile'
Simple feature collection with 526 features and 8 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 4901.188 ymin: 25529.08 xmax: 46948.22 ymax: 49233.6
Projected CRS: SVY21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>familyservices <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/Onemap"</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">layer =</span> <span class="st">"family"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `family' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/geospatial/Onemap' 
  using driver `ESRI Shapefile'
Simple feature collection with 48 features and 7 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 12836.2 ymin: 28549.79 xmax: 42512.91 ymax: 47397.09
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>childcare <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/Onemap"</span>,</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">layer =</span> <span class="st">"childcare"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `childcare' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/geospatial/Onemap' 
  using driver `ESRI Shapefile'
Simple feature collection with 1925 features and 5 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 11810.03 ymin: 25596.33 xmax: 45404.24 ymax: 49300.88
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>We will make use of st_read() from the sf package to load the data in</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"MP14_SUBZONE_WEB_PL"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MP14_SUBZONE_WEB_PL' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 323 features and 15 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33
Projected CRS: SVY21</code></pre>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p>We will make use of st_read() from the sf package to load the data in</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Bus_stop <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial"</span>,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">layer =</span> <span class="st">"BusStop"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `BusStop' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 5159 features and 3 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82
Projected CRS: SVY21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>MRT <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/lta-mrt-station-exit-kml.kml"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `MRT_EXITS' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/geospatial/lta-mrt-station-exit-kml.kml' 
  using driver `KML'
Simple feature collection with 474 features and 2 fields
Geometry type: POINT
Dimension:     XYZ
Bounding box:  xmin: 103.6368 ymin: 1.264972 xmax: 103.9893 ymax: 1.449157
z_range:       zmin: 0 zmax: 0
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p>We will make use of read_csv() from the readr package to read the csv file into Rstudio</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Resale <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/resale-flat-prices-based-on-registration-date-from-jan-2017-onwards.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>Schools <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/schools.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>Malls <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/aspatial/mall_coordinates_updated.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="data-wrangling" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data Wrangling</h1>
<section id="hdb-resale-price" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="hdb-resale-price"><span class="header-section-number">3.1</span> HDB Resale Price</h2>
<p>For the purpose of this take-home exercise, we will only be using five-room flat and training transaction period should be from January 2021 and December 2022.</p>
<p>From the output above, the variables we want are:</p>
<ul>
<li>Resale Price</li>
<li>Month</li>
<li>Flat Type</li>
<li>Area of the unit</li>
<li>Floor level</li>
<li>Remaining Lease</li>
<li>Flat Model</li>
</ul>
<section id="story-and-date-adjustents" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="story-and-date-adjustents"><span class="header-section-number">3.1.1</span> Story and Date adjustents</h3>
<p>We will see the unique values of story by running the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(Resale<span class="sc">$</span>storey_range)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "10 TO 12" "01 TO 03" "04 TO 06" "07 TO 09" "13 TO 15" "19 TO 21"
 [7] "22 TO 24" "16 TO 18" "34 TO 36" "28 TO 30" "37 TO 39" "49 TO 51"
[13] "25 TO 27" "40 TO 42" "31 TO 33" "46 TO 48" "43 TO 45"</code></pre>
</div>
</div>
<p>As we can see, there are 17 factor levels.</p>
<p>When dealing with categorical variables, there are several ways to manipulate the data.</p>
<p>These are some ways to deal with categorical variables:</p>
<ol type="1">
<li>Set it as a factor, to which R will recognize them as binary variables automatically.</li>
<li>Set categorical variable as multiple binary variable columns, assigning values 1 and 0.</li>
<li>Set categorical variables as ordinal numbers.</li>
</ol>
<p>In the case of story levels, as they are ascending in nature, we can use No.&nbsp;3, which is to set them as ordinal variables.</p>
<p>The code chunk below will sequence the story levels, assigning value 1 to “01 TO 03”, 2 to “04 TO 06”, …, 17 to “49 TO 51”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the story levels and ordinal values</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>story_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"01 TO 03"</span>, <span class="st">"04 TO 06"</span>, <span class="st">"07 TO 09"</span>, <span class="st">"10 TO 12"</span>, <span class="st">"13 TO 15"</span>, <span class="st">"16 TO 18"</span>, <span class="st">"19 TO 21"</span>, <span class="st">"22 TO 24"</span>, <span class="st">"25 TO 27"</span>, <span class="st">"28 TO 30"</span>, <span class="st">"31 TO 33"</span>, <span class="st">"34 TO 36"</span>, <span class="st">"37 TO 39"</span>, <span class="st">"40 TO 42"</span>, <span class="st">"43 TO 45"</span>, <span class="st">"46 TO 48"</span>, <span class="st">"49 TO 51"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>story_ordinal <span class="ot">&lt;-</span> <span class="fu">seq_along</span>(story_levels)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the ordinal variable based on the story column</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>Resale<span class="sc">$</span>Story_Ordinal <span class="ot">&lt;-</span> story_ordinal[<span class="fu">match</span>(Resale<span class="sc">$</span>storey_range, story_levels)]</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set the labels for the ordinal variable</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(Resale<span class="sc">$</span>Story_Ordinal) <span class="ot">&lt;-</span> story_levels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="date" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="date"><span class="header-section-number">3.1.2</span> Date</h3>
<p>Next we will set the Date column as date type and also ensure Story_Ordinal is of numeric type.</p>
<p>To check the data set, you can run glimpse() from the dplyr package to see the data types of each variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>Resale <span class="ot">&lt;-</span> Resale <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">month =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(month, <span class="st">"-01"</span>), <span class="at">format =</span><span class="st">"%Y-%m-%d"</span>),</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">Story_Ordinal =</span> <span class="fu">as.numeric</span>(Story_Ordinal))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="flat-model" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="flat-model"><span class="header-section-number">3.1.3</span> Flat Model</h3>
<p>Next, we will set Flat Model as a binary variable by running the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>Resale <span class="ot">&lt;-</span> Resale <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> flat_model,</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_from =</span> flat_model, </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fn =</span> <span class="fu">list</span>(<span class="at">flat_model =</span> <span class="sc">~</span><span class="dv">1</span>), </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">values_fill =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="remaining-lease" class="level3" data-number="3.1.4">
<h3 data-number="3.1.4" class="anchored" data-anchor-id="remaining-lease"><span class="header-section-number">3.1.4</span> Remaining Lease</h3>
<p>We will settle the remaining lease by running the code chunk below: This turns remaining_lease from chr type to numeric in terms of units, years.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Splits the string by year and month, using str_split from the stringr package</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>str_list <span class="ot">&lt;-</span> <span class="fu">str_split</span>(Resale<span class="sc">$</span>remaining_lease, <span class="st">" "</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(str_list)) {</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(<span class="fu">unlist</span>(str_list[i])) <span class="sc">&gt;</span> <span class="dv">2</span>) {</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>      year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(str_list[i])[<span class="dv">1</span>])</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>      month <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(str_list[i])[<span class="dv">3</span>])</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>      Resale<span class="sc">$</span>remaining_lease[i] <span class="ot">&lt;-</span> year <span class="sc">+</span> <span class="fu">round</span>(month<span class="sc">/</span><span class="dv">12</span>, <span class="dv">2</span>)</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> {</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>    year <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">unlist</span>(str_list[i])[<span class="dv">1</span>])</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>    Resale<span class="sc">$</span>remaining_lease[i] <span class="ot">&lt;-</span> year</span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>Resale <span class="ot">&lt;-</span> Resale <span class="sc">%&gt;%</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">remaining_lease =</span><span class="fu">as.numeric</span>(remaining_lease))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can take a look at the dataframe now by using glimpse() from the dplyr package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Resale)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 148,000
Columns: 11
$ month               &lt;chr&gt; "2017-01", "2017-01", "2017-01", "2017-01", "2017-…
$ town                &lt;chr&gt; "ANG MO KIO", "ANG MO KIO", "ANG MO KIO", "ANG MO …
$ flat_type           &lt;chr&gt; "2 ROOM", "3 ROOM", "3 ROOM", "3 ROOM", "3 ROOM", …
$ block               &lt;chr&gt; "406", "108", "602", "465", "601", "150", "447", "…
$ street_name         &lt;chr&gt; "ANG MO KIO AVE 10", "ANG MO KIO AVE 4", "ANG MO K…
$ storey_range        &lt;chr&gt; "10 TO 12", "01 TO 03", "01 TO 03", "04 TO 06", "0…
$ floor_area_sqm      &lt;dbl&gt; 44, 67, 67, 68, 67, 68, 68, 67, 68, 67, 68, 67, 67…
$ flat_model          &lt;chr&gt; "Improved", "New Generation", "New Generation", "N…
$ lease_commence_date &lt;dbl&gt; 1979, 1978, 1980, 1980, 1980, 1981, 1979, 1976, 19…
$ remaining_lease     &lt;chr&gt; "61 years 04 months", "60 years 07 months", "62 ye…
$ resale_price        &lt;dbl&gt; 232000, 250000, 262000, 265000, 265000, 275000, 28…</code></pre>
</div>
</div>
<p>We will first filter out the relevant columns we want by running the code chunk below:</p>
<p>select() helps to select the columns we want and filter() helps us to filter to the specific two months. These two functions come from the dplyr package.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Training Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Test Data</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>Resale_train <span class="ot">&lt;-</span> Resale <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span> <span class="st">"2021-01-01"</span> <span class="sc">&amp;</span> month <span class="sc">&lt;=</span> <span class="st">"2022-12-01"</span>,</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>         flat_type <span class="sc">==</span> <span class="st">"5 ROOM"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will save Resale_train as a rds file for easy retrieval</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(Resale_train, <span class="st">"data/aspatial/Resale_train.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>Resale_train <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/Resale_train.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Resale_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 14,508
Columns: 28
$ month                    &lt;date&gt; 2021-01-01, 2021-01-01, 2021-01-01, 2021-01-…
$ block                    &lt;chr&gt; "551", "305", "520", "253", "423", "617", "31…
$ street_name              &lt;chr&gt; "ANG MO KIO AVE 10", "ANG MO KIO AVE 1", "ANG…
$ floor_area_sqm           &lt;dbl&gt; 118, 123, 118, 128, 133, 133, 110, 110, 110, …
$ remaining_lease          &lt;dbl&gt; 59.08, 55.58, 58.67, 74.25, 71.25, 74.50, 84.…
$ resale_price             &lt;dbl&gt; 483000, 590000, 629000, 670000, 680000, 76000…
$ Story_Ordinal            &lt;dbl&gt; 1, 5, 6, 3, 1, 5, 8, 5, 6, 6, 5, 5, 8, 1, 2, …
$ Improved                 &lt;dbl&gt; 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, …
$ `New Generation`         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ DBSS                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, …
$ Standard                 &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, …
$ Apartment                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Simplified               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Model A`                &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Premium Apartment`      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Adjoined flat`          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Model A-Maisonette`     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Maisonette               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Type S1`                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Type S2`                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Model A2`               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Terrace                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Improved-Maisonette`    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Premium Maisonette`     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Multi Generation`       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Premium Apartment Loft` &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `2-room`                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `3Gen`                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</code></pre>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>Resale_test <span class="ot">&lt;-</span> Resale <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(month <span class="sc">&gt;=</span><span class="st">"2023-01-01"</span> <span class="sc">&amp;</span> month <span class="sc">&lt;=</span><span class="st">"2023-02-01"</span>,</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>         flat_type <span class="sc">==</span> <span class="st">"5 ROOM"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will save Resale_train as a rds file for easy retrieval</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(Resale_test, <span class="st">"data/aspatial/Resale_test.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>Resale_test <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/Resale_test.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(Resale_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 998
Columns: 28
$ month                    &lt;date&gt; 2023-01-01, 2023-01-01, 2023-01-01, 2023-02-…
$ block                    &lt;chr&gt; "306", "306", "402", "431", "259", "259", "17…
$ street_name              &lt;chr&gt; "ANG MO KIO AVE 1", "ANG MO KIO AVE 1", "ANG …
$ floor_area_sqm           &lt;dbl&gt; 123, 123, 119, 119, 135, 135, 119, 133, 135, …
$ remaining_lease          &lt;dbl&gt; 53.58, 53.58, 55.42, 54.92, 58.42, 58.17, 69.…
$ resale_price             &lt;dbl&gt; 682888.0, 695000.0, 658888.0, 748000.0, 79000…
$ Story_Ordinal            &lt;dbl&gt; 6, 2, 4, 8, 5, 1, 2, 5, 4, 7, 7, 4, 2, 3, 3, …
$ Improved                 &lt;dbl&gt; 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, …
$ `New Generation`         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ DBSS                     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Standard                 &lt;dbl&gt; 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Apartment                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Simplified               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Model A`                &lt;dbl&gt; 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, …
$ `Premium Apartment`      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Adjoined flat`          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Model A-Maisonette`     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Maisonette               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Type S1`                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Type S2`                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Model A2`               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Terrace                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Improved-Maisonette`    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Premium Maisonette`     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Multi Generation`       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `Premium Apartment Loft` &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `2-room`                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ `3Gen`                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>You may be wondering why I had removed LeaseBegin as that denotes the age of the apartment. This is due to the issue of high multicollinearity in statistics. Intuitively, HDB only has 99year lease and as such, remaining_lease has a perfect inverse relationship to LeaseBegin. For example a 9 year old apartment would have a remaining lease of (99-9) = 90 years.</p>
</section>
<section id="inserting-geometries" class="level3" data-number="3.1.5">
<h3 data-number="3.1.5" class="anchored" data-anchor-id="inserting-geometries"><span class="header-section-number">3.1.5</span> Inserting geometries</h3>
<p>Next, once our data set has been cleaned to its relevant variables, we will insert the geometries of the resale apartment location.</p>
<p>To do this, we will have to obtain the geometries from this <a href="https://developers.onemap.sg/commonapi/search">url</a>.</p>
<p>This code is referenced from <a href="https://is415-msty.netlify.app/posts/2021-10-25-take-home-exercise-3/">Megan’s work</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"httr"</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>geocode <span class="ot">&lt;-</span> <span class="cf">function</span>(block, streetname) {</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  base_url <span class="ot">&lt;-</span> <span class="st">"https://developers.onemap.sg/commonapi/search"</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  address <span class="ot">&lt;-</span> <span class="fu">paste</span>(block, streetname, <span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"searchVal"</span> <span class="ot">=</span> address, </span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"returnGeom"</span> <span class="ot">=</span> <span class="st">"Y"</span>,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">"getAddrDetails"</span> <span class="ot">=</span> <span class="st">"N"</span>,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                <span class="st">"pageNum"</span> <span class="ot">=</span> <span class="st">"1"</span>)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">GET</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  restext<span class="ot">&lt;-</span><span class="fu">content</span>(res, <span class="at">as=</span><span class="st">"text"</span>)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(restext)  <span class="sc">%&gt;%</span> </span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">"results.LATITUDE"</span>, <span class="st">"results.LONGITUDE"</span>)</span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In both Training and Test Data, we will use this function and a for loop that iterates between each row of the dataframe.</p>
<p>This is done to input the block and street number into the function, geocode() and inputs the results into the LATITUDE and LONGITUDE columns.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Training Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Testing Data</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>Resale_train<span class="sc">$</span>LATITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>Resale_train<span class="sc">$</span>LONGITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Resale_train)){</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  temp_output <span class="ot">&lt;-</span> <span class="fu">geocode</span>(Resale_train[i, <span class="dv">2</span>], Resale_train[i, <span class="dv">3</span>])</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  Resale_train<span class="sc">$</span>LATITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LATITUDE</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  Resale_train<span class="sc">$</span>LONGITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LONGITUDE</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>Resale_test<span class="sc">$</span>LATITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>Resale_test<span class="sc">$</span>LONGITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Resale_test)){</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  temp_output <span class="ot">&lt;-</span> <span class="fu">geocode</span>(Resale_test[i, <span class="dv">2</span>], Resale_test[i, <span class="dv">3</span>])</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>  Resale_test<span class="sc">$</span>LATITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LATITUDE</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>  Resale_test<span class="sc">$</span>LONGITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LONGITUDE</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="convert-into-resale_2023-dataframe-into-sf" class="level3" data-number="3.1.6">
<h3 data-number="3.1.6" class="anchored" data-anchor-id="convert-into-resale_2023-dataframe-into-sf"><span class="header-section-number">3.1.6</span> Convert into Resale_2023 dataframe into sf</h3>
<p>By using st_as_sf() from the sf package, we can convert Resale_2023 into an sf and then transform the crs to EPSG:: 3414 which is the coordinate reference system for Singapore.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Training Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Test Data</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>Resale_training_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(Resale_train, </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, <span class="st">"LATITUDE"</span>),</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can store it as a shapefile for future retrieval.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(Resale_training_sf, </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/aspatial"</span>, </span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"resale_train_sf"</span>,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>Resale_training_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/aspatial"</span>,</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">layer =</span> <span class="st">"resale_train_sf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `resale_train_sf' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/aspatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 14508 features and 28 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6958.193 ymin: 28157.26 xmax: 42645.18 ymax: 48741.06
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>Resale_test_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(Resale_test, </span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, <span class="st">"LATITUDE"</span>),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can store it as a shapefile for future retrieval</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_write</span>(Resale_test_sf, </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">dsn =</span> <span class="st">"data/aspatial"</span>, </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">layer =</span> <span class="st">"Resale_test_sf"</span>,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">driver =</span> <span class="st">"ESRI Shapefile"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>Resale_test_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/aspatial"</span>,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">layer =</span> <span class="st">"Resale_test_sf"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `Resale_test_sf' from data source 
  `/Users/junhaoteo/Documents/junhao2309/IS415/Take-Home_Ex/Take-Home_Ex03/data/aspatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 998 features and 28 fields
Geometry type: POINT
Dimension:     XY
Bounding box:  xmin: 6958.193 ymin: 28248.87 xmax: 42623.63 ymax: 48625.64
Projected CRS: SVY21 / Singapore TM</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="aspatial-data-wrangling" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="aspatial-data-wrangling"><span class="header-section-number">3.2</span> Aspatial Data Wrangling</h2>
<p>For schools, the dataframe holds several levels of schools. For the purpose the regression, we will focus only on primary and secondary schools.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(Schools<span class="sc">$</span>mainlevel_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PRIMARY"               "SECONDARY"             "JUNIOR COLLEGE"       
[4] "MIXED LEVELS"          "CENTRALISED INSTITUTE"</code></pre>
</div>
</div>
<p>We will create the respective primary school and secondary school dataframe.</p>
<p>We will also make some tweaks to the geocode function created above, that takes in postal code instead of block and street.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>geocode <span class="ot">&lt;-</span> <span class="cf">function</span>(postal) {</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  base_url <span class="ot">&lt;-</span> <span class="st">"https://developers.onemap.sg/commonapi/search"</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  query <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"searchVal"</span> <span class="ot">=</span> postal, </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"returnGeom"</span> <span class="ot">=</span> <span class="st">"Y"</span>,</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">"getAddrDetails"</span> <span class="ot">=</span> <span class="st">"N"</span>,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>                <span class="st">"pageNum"</span> <span class="ot">=</span> <span class="st">"1"</span>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> <span class="fu">GET</span>(base_url, <span class="at">query =</span> query)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  restext<span class="ot">&lt;-</span><span class="fu">content</span>(res, <span class="at">as=</span><span class="st">"text"</span>)</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(restext)  <span class="sc">%&gt;%</span> </span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">"results.LATITUDE"</span>, <span class="st">"results.LONGITUDE"</span>)</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Primary School</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Secondary School</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>Primary <span class="ot">&lt;-</span> Schools <span class="sc">%&gt;%</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mainlevel_code <span class="sc">==</span> <span class="st">"PRIMARY"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(school_name,postal_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>Primary<span class="sc">$</span>LATITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>Primary<span class="sc">$</span>LONGITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Primary)){</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  temp_output <span class="ot">&lt;-</span> <span class="fu">geocode</span>(Primary[i, <span class="dv">2</span>])</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  Primary<span class="sc">$</span>LATITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LATITUDE</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  Primary<span class="sc">$</span>LONGITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LONGITUDE</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(Primary, <span class="st">"data/aspatial/Primary.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>Primary <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/Primary.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>Secondary <span class="ot">&lt;-</span> Schools <span class="sc">%&gt;%</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(mainlevel_code <span class="sc">==</span> <span class="st">"SECONDARY"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(school_name,postal_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we will change the postal code of <a href="https://www.moe.gov.sg/schoolfinder/schooldetail?schoolname=zhenghua-secondary-school">ZHENGHUA&nbsp;SECONDARY&nbsp;SCHOOL</a> as it has the wrong postal code. We found out about this after checking that there was an error after running the geocode. Hence, it is a good habit to check on your dataframe for any missing geometries before moving forward.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>Secondary[<span class="dv">137</span>,<span class="dv">2</span>]<span class="ot">&lt;-</span> <span class="st">"679962"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can rerun the code.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>Secondary<span class="sc">$</span>LATITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>Secondary<span class="sc">$</span>LONGITUDE <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(Secondary)){</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  temp_output <span class="ot">&lt;-</span> <span class="fu">geocode</span>(Secondary[i, <span class="dv">2</span>])</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  Secondary<span class="sc">$</span>LATITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LATITUDE</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  Secondary<span class="sc">$</span>LONGITUDE[i] <span class="ot">&lt;-</span> temp_output<span class="sc">$</span>results.LONGITUDE</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(Secondary, <span class="at">file =</span> <span class="st">"data/aspatial/Secondary.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>Secondary <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/Secondary.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>For Primary_sch, Secondary_sch and Mall, we need to convert them into sf and transform it to the correct CRS.</p>
<p>Primary School:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>Primary_sf <span class="ot">&lt;-</span> Primary <span class="sc">%&gt;%</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"LONGITUDE"</span>, <span class="st">"LATITUDE"</span>),</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Good Primary Schools:</p>
<p>We will refer to <a href="https://schlah.com/primary-schools">schlah</a> list of good primary schools. Note that CANOSSA HIGH SCHOOL in schlah webpage is known as CANOSSA CATHOLIC PRIMARY SCHOOL.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>Good_Prisch <span class="ot">&lt;-</span> Primary_sf <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(school_name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"NANYANG PRIMARY SCHOOL"</span>,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"TAO NAN SCHOOL"</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"CANOSSA CATHOLIC PRIMARY SCHOOL"</span>,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"NAN HUA PRIMARY SCHOOL"</span>,</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"ST. HILDA'S PRIMARY SCHOOL"</span>,</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"HENRY PARK PRIMARY SCHOOL"</span>,</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"ANGLO-CHINESE SCHOOL (PRIMARY)"</span>,</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"RAFFLES GIRLS' PRIMARY SCHOOL"</span>,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"PEI HWA PRESBYTERIAN PRIMARY SCHOOL"</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>                            ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Secondary School:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>Secondary_sf <span class="ot">&lt;-</span> Secondary <span class="sc">%&gt;%</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"LONGITUDE"</span>,<span class="st">"LATITUDE"</span>),</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Malls:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>malls <span class="ot">&lt;-</span> Malls <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"longitude"</span>, <span class="st">"latitude"</span>),</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">crs =</span> <span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>CBD Area:</p>
<p>As for the CBD area, we will use a centre point coordinate to illustrate proximity to CBD Area.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">&lt;-</span> <span class="fl">1.287953</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>lng <span class="ot">&lt;-</span> <span class="fl">103.851784</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>cbd_sf <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(lat, lng) <span class="sc">%&gt;%</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>(<span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"lng"</span>, <span class="st">"lat"</span>), <span class="at">crs=</span><span class="dv">4326</span>) <span class="sc">%&gt;%</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ensure-all-datasets-are-in-epsg3414" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="ensure-all-datasets-are-in-epsg3414"><span class="header-section-number">3.3</span> Ensure all datasets are in EPSG:3414</h2>
<p>Aside from the onemap variables, we need to check the geospatial data and the other data sets, primary school, secondary school and shopping malls.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">st_crs</span>(mpsz) ; <span class="fu">st_crs</span>(Bus_stop) ; <span class="fu">st_crs</span>(MRT) ; <span class="fu">st_crs</span>(supermarkets)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: SVY21 
  wkt:
PROJCRS["SVY21",
    BASEGEOGCRS["SVY21[WGS84]",
        DATUM["World Geodetic System 1984",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ID["EPSG",6326]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["Degree",0.0174532925199433]]],
    CONVERSION["unnamed",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]]]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: SVY21 
  wkt:
PROJCRS["SVY21",
    BASEGEOGCRS["WGS 84",
        DATUM["World Geodetic System 1984",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ID["EPSG",6326]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["Degree",0.0174532925199433]]],
    CONVERSION["unnamed",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]]]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS["WGS 84",
    DATUM["World Geodetic System 1984",
        ELLIPSOID["WGS 84",6378137,298.257223563,
            LENGTHUNIT["metre",1]]],
    PRIMEM["Greenwich",0,
        ANGLEUNIT["degree",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS["geodetic latitude (Lat)",north,
            ORDER[1],
            ANGLEUNIT["degree",0.0174532925199433]],
        AXIS["geodetic longitude (Lon)",east,
            ORDER[2],
            ANGLEUNIT["degree",0.0174532925199433]],
    ID["EPSG",4326]]</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Coordinate Reference System:
  User input: SVY21 
  wkt:
PROJCRS["SVY21",
    BASEGEOGCRS["WGS 84",
        DATUM["World Geodetic System 1984",
            ELLIPSOID["WGS 84",6378137,298.257223563,
                LENGTHUNIT["metre",1]],
            ID["EPSG",6326]],
        PRIMEM["Greenwich",0,
            ANGLEUNIT["Degree",0.0174532925199433]]],
    CONVERSION["unnamed",
        METHOD["Transverse Mercator",
            ID["EPSG",9807]],
        PARAMETER["Latitude of natural origin",1.36666666666667,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8801]],
        PARAMETER["Longitude of natural origin",103.833333333333,
            ANGLEUNIT["Degree",0.0174532925199433],
            ID["EPSG",8802]],
        PARAMETER["Scale factor at natural origin",1,
            SCALEUNIT["unity",1],
            ID["EPSG",8805]],
        PARAMETER["False easting",28001.642,
            LENGTHUNIT["metre",1],
            ID["EPSG",8806]],
        PARAMETER["False northing",38744.572,
            LENGTHUNIT["metre",1],
            ID["EPSG",8807]]],
    CS[Cartesian,2],
        AXIS["(E)",east,
            ORDER[1],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]],
        AXIS["(N)",north,
            ORDER[2],
            LENGTHUNIT["metre",1,
                ID["EPSG",9001]]]]</code></pre>
</div>
</div>
<p>We notice that the CRS for these 3 geospatial data are not correct.</p>
<p>We will use st_transformed as taught previously to convert it to EPSG:3414.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> mpsz <span class="sc">%&gt;%</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>Bus_stop <span class="ot">&lt;-</span> Bus_stop <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>MRT <span class="ot">&lt;-</span> MRT <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>supermarkets <span class="ot">&lt;-</span> supermarkets <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_transform</span>(<span class="at">crs =</span> <span class="dv">3414</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="checking-invalid-geometries" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="checking-invalid-geometries"><span class="header-section-number">3.4</span> Checking invalid geometries</h2>
<p>We should also check for any invalid geometries in our data.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Onemap variable checks</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">DATA.GOV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">Aspatial Data</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(communityclubs)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(eldercare)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(familyservices)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(hawker)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(kindergartens)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(parks)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(pharmacy)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(supermarkets)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(childcare)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>We can see that for the oneMap variables, there are no invalid geometries.</p>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(mpsz)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(Bus_stop)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(MRT)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>For the data obtained from DATA.GOV, there are some invalid geometries</p>
<p>We will proceed to remove them</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>mpsz <span class="ot">&lt;-</span> <span class="fu">st_make_valid</span>(mpsz)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(Primary_sf)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(Secondary_sf)<span class="sc">==</span> <span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">st_is_valid</span>(malls)<span class="sc">==</span><span class="cn">FALSE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>There is no invalid geometries in the aspatial data set.</p>
</div>
</div>
</div>
</section>
<section id="removing-unnecessary-columns" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="removing-unnecessary-columns"><span class="header-section-number">3.5</span> Removing Unnecessary columns</h2>
<p>We will only need the name and the geometries so we can exclude the rest of the columns</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">Onemap</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">DATA.GOV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">Aspatial Data</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>communityclubs <span class="ot">&lt;-</span> communityclubs <span class="sc">%&gt;%</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>eldercare <span class="ot">&lt;-</span> eldercare <span class="sc">%&gt;%</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>familyservices <span class="ot">&lt;-</span> familyservices <span class="sc">%&gt;%</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>hawker <span class="ot">&lt;-</span> hawker <span class="sc">%&gt;%</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>kindergartens <span class="ot">&lt;-</span> kindergartens <span class="sc">%&gt;%</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>parks <span class="ot">&lt;-</span> parks <span class="sc">%&gt;%</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>pharmacy <span class="ot">&lt;-</span> pharmacy <span class="sc">%&gt;%</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>supermarkets <span class="ot">&lt;-</span> supermarkets <span class="sc">%&gt;%</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>childcare <span class="ot">&lt;-</span> childcare <span class="sc">%&gt;%</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>Bus_stop <span class="ot">&lt;-</span> <span class="fu">select</span>(Bus_stop, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For MRT, we will need to drop the Z-dimension. This can be seen when you View(MRT).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>MRT_Station <span class="ot">&lt;-</span> <span class="fu">st_zm</span>(MRT) <span class="sc">%&gt;%</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>Primary_sf <span class="ot">&lt;-</span> <span class="fu">select</span>(Primary_sf, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>Secondary_sf <span class="ot">&lt;-</span> <span class="fu">select</span>(Secondary_sf, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>malls <span class="ot">&lt;-</span> <span class="fu">select</span>(malls, name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="check-na-values" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="check-na-values"><span class="header-section-number">3.6</span> Check NA values</h2>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">Onemap</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">DATA.GOV</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">Aspatial Data</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>communityclubs[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(communityclubs))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21 / Singapore TM
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>eldercare[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(eldercare))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21 / Singapore TM
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>familyservices[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(familyservices))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21 / Singapore TM
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>hawker[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(hawker))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21 / Singapore TM
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>kindergartens[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(kindergartens))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21 / Singapore TM
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>parks[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(parks))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21 / Singapore TM
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>pharmacy[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(pharmacy))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21 / Singapore TM
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>supermarkets[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(supermarkets))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21 / Singapore TM
[1] LIC_NAME geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a>childcare[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(childcare))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21 / Singapore TM
[1] NAME     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<p>We notice that family services has NA values, we will proceed to remove them using na.omit()</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>familyservices<span class="ot">&lt;-</span> <span class="fu">na.omit</span>(familyservices, <span class="fu">c</span>(<span class="st">"ADDRESSBUI"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>Bus_stop[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(Bus_stop))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21 / Singapore TM
[1] BUS_STOP_N geometry  
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>MRT_Station[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(MRT_Station))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 1 field
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21 / Singapore TM
[1] Name     geometry
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>mpsz[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(mpsz))<span class="sc">!=</span><span class="dv">0</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 0 features and 15 fields
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: SVY21 / Singapore TM
 [1] OBJECTID   SUBZONE_NO SUBZONE_N  SUBZONE_C  CA_IND     PLN_AREA_N
 [7] PLN_AREA_C REGION_N   REGION_C   INC_CRC    FMEL_UPD_D X_ADDR    
[13] Y_ADDR     SHAPE_Leng SHAPE_Area geometry  
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(Primary_sf) <span class="sc">==</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(Secondary_sf) <span class="sc">==</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">is.na</span>(malls) <span class="sc">==</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>There is no NA values in the aspatial data</p>
</div>
</div>
</div>
</section>
</section>
<section id="visualisation" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Visualisation</h1>
<p>We will visualize each variable on its own to see how they are being scattered.</p>
<p>This is done by using tm_shape(), tm_polygons, tm_dots() from the tmap package. Since these maps are set to “plot”, mpsz sets the Singapore boundaries while tm_dots plots the points onto the polygon.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">Subzone</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">MRT Stations</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">Bus Stops</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">Community Club</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-5" role="tab" aria-controls="tabset-9-5" aria-selected="false">Eldercare</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-6" role="tab" aria-controls="tabset-9-6" aria-selected="false">Family Service</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-7" role="tab" aria-controls="tabset-9-7" aria-selected="false">Hawker Centre</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-8" role="tab" aria-controls="tabset-9-8" aria-selected="false">Kindergarten</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-9" role="tab" aria-controls="tabset-9-9" aria-selected="false">Malls</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-10" role="tab" aria-controls="tabset-9-10" aria-selected="false">Parks</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-11-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-11" role="tab" aria-controls="tabset-9-11" aria-selected="false">Pharmacies</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-12-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-12" role="tab" aria-controls="tabset-9-12" aria-selected="false">Childcare</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-13-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-13" role="tab" aria-controls="tabset-9-13" aria-selected="false">Primary School</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-14-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-14" role="tab" aria-controls="tabset-9-14" aria-selected="false">Secondary School</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(MRT_Station) <span class="sc">+</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span> </span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Bus_stop) <span class="sc">+</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="at">col =</span> <span class="st">"red"</span>,</span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">size =</span> <span class="fl">0.0075</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Note that the points outside of Singapore boundaries are related to bus stop at Johor Bahru and they are valid points to our analysis.</p>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(communityclubs) <span class="sc">+</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(eldercare) <span class="sc">+</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(familyservices) <span class="sc">+</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(hawker) <span class="sc">+</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(kindergartens) <span class="sc">+</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-9-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(malls) <span class="sc">+</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-10-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(parks) <span class="sc">+</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-11" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-11-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(pharmacy) <span class="sc">+</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-12" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-12-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(childcare) <span class="sc">+</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-13" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-13-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Primary_sf) <span class="sc">+</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-9-14" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-14-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(mpsz) <span class="sc">+</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(Secondary_sf) <span class="sc">+</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-117-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="proximity-distance-calculator" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Proximity distance calculator</h1>
<p>Here, we will need to calculate the distance between each variable to the resale apartment.</p>
<p>The code below creates a function called proximity() that takes in 3 values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(units)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(matrixStats)</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>proximity <span class="ot">&lt;-</span> <span class="cf">function</span>(df1, df2, varname) {</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>  dist_matrix <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(df1, df2) <span class="sc">%&gt;%</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_units</span>()</span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a>  df1[,varname] <span class="ot">&lt;-</span> <span class="fu">rowMins</span>(dist_matrix)</span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df1) }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The code chunks in training and test data essentially calculates the proximity between Resale flats and the variable. This is piped each time, creating a new column with the 3rd input name and assigned to the object, training_resale/test_resale.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">Training Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">Test Data</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>training_resale <span class="ot">&lt;-</span> </span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the columns will be truncated later on when viewing </span></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># so we're limiting ourselves to two-character columns for ease of viewing between</span></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(Resale_training_sf, cbd_sf, <span class="st">"PROX_CBD"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(.,Bus_stop, <span class="st">"PROX_BUS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., communityclubs, <span class="st">"PROX_CLUBS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., eldercare, <span class="st">"PROX_ELDERCARE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., familyservices, <span class="st">"PROX_FAM"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., MRT_Station, <span class="st">"PROX_MRT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., hawker, <span class="st">"PROX_HAWKER"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., kindergartens, <span class="st">"PROX_KINDERGARTENS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., pharmacy, <span class="st">"PROX_PHARMACY"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., parks, <span class="st">"PROX_PARK"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., malls, <span class="st">"PROX_MALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., supermarkets, <span class="st">"PROX_SPRMKT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., childcare, <span class="st">"PROX_CHILDCARE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., Primary_sf, <span class="st">"PROX_PRISCH"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., Good_Prisch, <span class="st">"PROX_GOODP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., Secondary_sf, <span class="st">"PROX_SECSCH"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will change the names of the column for easy recognition and referencing. This is done using mutate() and rename() from the dplyr package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>training_resale <span class="ot">&lt;-</span> training_resale <span class="sc">%&gt;%</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>() <span class="sc">%&gt;%</span></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"AREA_SQM"</span> <span class="ot">=</span> <span class="st">"flr_r_s"</span>,</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PRICE"</span> <span class="ot">=</span> <span class="st">"rsl_prc"</span>,</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"REMAINING_LEASE"</span> <span class="ot">=</span> <span class="st">"rmnng_l"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="st">`</span><span class="at">PRICE</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>test_resale <span class="ot">&lt;-</span> </span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># the columns will be truncated later on when viewing </span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># so we're limiting ourselves to two-character columns for ease of viewing between</span></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(Resale_test_sf, cbd_sf, <span class="st">"PROX_CBD"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(.,Bus_stop, <span class="st">"PROX_BUS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., communityclubs, <span class="st">"PROX_CLUBS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., eldercare, <span class="st">"PROX_ELDERCARE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., familyservices, <span class="st">"PROX_FAM"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., MRT_Station, <span class="st">"PROX_MRT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., hawker, <span class="st">"PROX_HAWKER"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., kindergartens, <span class="st">"PROX_KINDERGARTENS"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., pharmacy, <span class="st">"PROX_PHARMACY"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., parks, <span class="st">"PROX_PARK"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., malls, <span class="st">"PROX_MALL"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., supermarkets, <span class="st">"PROX_SPRMKT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., childcare, <span class="st">"PROX_CHILDCARE"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., Primary_sf, <span class="st">"PROX_PRISCH"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-18"><a href="#cb183-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., Good_Prisch, <span class="st">"PROX_GOODP"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-19"><a href="#cb183-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">proximity</span>(., Secondary_sf, <span class="st">"PROX_SECSCH"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will change the names of the columns for easy recognition and referencing. This is done using mutate() and rename() from the dplyr package</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>test_resale <span class="ot">&lt;-</span> test_resale <span class="sc">%&gt;%</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>() <span class="sc">%&gt;%</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"AREA_SQM"</span> <span class="ot">=</span> <span class="st">"flr_r_s"</span>,</span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">"PRICE"</span> <span class="ot">=</span> <span class="st">"rsl_prc"</span>,</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"REMAINING_LEASE"</span> <span class="ot">=</span> <span class="st">"rmnng_l"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(<span class="st">`</span><span class="at">PRICE</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<section id="facility-count-within-radius-calculation" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="facility-count-within-radius-calculation"><span class="header-section-number">5.1</span> Facility Count within Radius Calculation</h2>
<p>Here, we want to find the number of facilities within a particular radius. Like above, we’ll use st_distance() to compute the distance between the flats and the desired facilities, and then sum up the observations with rowSums(). The values will be appended to the data frame as a new column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a>num_radius <span class="ot">&lt;-</span> <span class="cf">function</span>(df1, df2, varname, radius) {</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>  dist_matrix <span class="ot">&lt;-</span> <span class="fu">st_distance</span>(df1, df2) <span class="sc">%&gt;%</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">drop_units</span>() <span class="sc">%&gt;%</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>()</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>  df1[,varname] <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(dist_matrix <span class="sc">&lt;=</span> radius)</span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df1)</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">Training Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">Test Data</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>training_resale <span class="ot">&lt;-</span> </span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(training_resale, kindergartens, <span class="st">"NUM_KNDRGTN"</span>, <span class="dv">350</span>) <span class="sc">%&gt;%</span></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(., childcare, <span class="st">"NUM_CHILDCARE"</span>, <span class="dv">350</span>) <span class="sc">%&gt;%</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(., Bus_stop, <span class="st">"NUM_BUS_STOP"</span>, <span class="dv">350</span>) <span class="sc">%&gt;%</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(., Primary_sf, <span class="st">"NUM_PRISCH"</span>, <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(., Secondary_sf, <span class="st">"NUM_SECSCH"</span>, <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Always make sure to save the object as an rds file for future referencing.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(training_resale, <span class="st">"data/aspatial/training_resale.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>test_resale <span class="ot">&lt;-</span> </span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(test_resale, kindergartens, <span class="st">"NUM_KNDRGTN"</span>, <span class="dv">350</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(., childcare, <span class="st">"NUM_CHILDCARE"</span>, <span class="dv">350</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(., Bus_stop, <span class="st">"NUM_BUS_STOP"</span>, <span class="dv">350</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(., Primary_sf, <span class="st">"NUM_PRISCH"</span>, <span class="dv">1000</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">num_radius</span>(., Secondary_sf, <span class="st">"NUM_SECSCH"</span>, <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Always make sure to save the object as an rds file for future referencing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(test_resale, <span class="st">"data/aspatial/test_resale.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="read-data-in" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Read Data in</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a>training_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/training_resale.rds"</span>)</span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/aspatial/test_resale.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">Training Data</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">Test Data</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(training_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 14,508
Columns: 50
$ PRICE              &lt;dbl&gt; 483000, 590000, 629000, 670000, 680000, 760000, 768…
$ month              &lt;date&gt; 2021-01-01, 2021-01-01, 2021-01-01, 2021-01-01, 20…
$ block              &lt;chr&gt; "551", "305", "520", "253", "423", "617", "315A", "…
$ strt_nm            &lt;chr&gt; "ANG MO KIO AVE 10", "ANG MO KIO AVE 1", "ANG MO KI…
$ AREA_SQM           &lt;dbl&gt; 118, 123, 118, 128, 133, 133, 110, 110, 110, 112, 1…
$ REMAINING_LEASE    &lt;dbl&gt; 59.08, 55.58, 58.67, 74.25, 71.25, 74.50, 84.33, 80…
$ Stry_Or            &lt;dbl&gt; 1, 5, 6, 3, 1, 5, 8, 5, 6, 6, 5, 5, 8, 1, 2, 3, 3, …
$ Improvd            &lt;dbl&gt; 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, …
$ NwGnrtn            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ DBSS               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, …
$ Standrd            &lt;dbl&gt; 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, …
$ Aprtmnt            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Simplfd            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Model.A            &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ PrmmApr            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Adjndfl            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ MdlA.Ms            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Maisntt            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Type.S1            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Type.S2            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ ModelA2            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Terrace            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Imprv.M            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ PrmmMsn            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ MltGnrt            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ PrmmApL            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ X2.room            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ X3Gen              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ PROX_CBD           &lt;dbl&gt; 9537.543, 8663.223, 9449.166, 9211.988, 8935.289, 1…
$ PROX_BUS           &lt;dbl&gt; 189.45342, 199.24454, 80.68454, 160.52022, 91.01582…
$ PROX_CLUBS         &lt;dbl&gt; 1039.74076, 600.65527, 250.17807, 511.71420, 414.13…
$ PROX_ELDERCARE     &lt;dbl&gt; 1064.6617, 190.8834, 789.1907, 147.6040, 441.8627, …
$ PROX_FAM           &lt;dbl&gt; 837.9872, 953.8865, 863.1507, 366.4593, 466.4299, 9…
$ PROX_MRT           &lt;dbl&gt; 1080.8607, 524.3923, 415.9309, 1634.1785, 218.2533,…
$ PROX_HAWKER        &lt;dbl&gt; 482.8156, 331.7637, 379.2242, 588.4497, 512.9672, 3…
$ PROX_KINDERGARTENS &lt;dbl&gt; 239.51930, 148.29403, 224.35730, 270.32452, 295.950…
$ PROX_PHARMACY      &lt;dbl&gt; 1254.2522, 439.1980, 455.9529, 1331.3597, 379.1169,…
$ PROX_PARK          &lt;dbl&gt; 735.9373, 580.8933, 308.7999, 283.8337, 257.6041, 3…
$ PROX_MALL          &lt;dbl&gt; 1213.2871, 441.6229, 549.4572, 1536.9839, 371.1503,…
$ PROX_SPRMKT        &lt;dbl&gt; 419.91387, 245.54343, 318.05791, 313.57577, 379.115…
$ PROX_CHILDCARE     &lt;dbl&gt; 239.51930, 111.38938, 127.59057, 102.48186, 288.529…
$ PROX_PRISCH        &lt;dbl&gt; 809.7020, 558.0558, 213.5757, 567.7924, 312.2025, 2…
$ PROX_GOODP         &lt;dbl&gt; 5849.176, 5370.382, 6221.695, 5429.407, 5759.906, 6…
$ PROX_SECSCH        &lt;dbl&gt; 792.7406, 451.2317, 113.4179, 152.8092, 317.5082, 4…
$ geometry           &lt;POINT [m]&gt; POINT (30820.82 39547.58), POINT (29412.84 38…
$ NUM_KNDRGTN        &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 0, …
$ NUM_CHILDCARE      &lt;dbl&gt; 3, 6, 4, 3, 3, 3, 5, 2, 6, 5, 6, 5, 5, 2, 4, 3, 2, …
$ NUM_BUS_STOP       &lt;dbl&gt; 2, 8, 6, 11, 6, 8, 4, 9, 5, 9, 7, 9, 9, 7, 6, 5, 2,…
$ NUM_PRISCH         &lt;dbl&gt; 1, 3, 2, 3, 3, 3, 4, 2, 2, 2, 2, 2, 2, 3, 2, 1, 3, …
$ NUM_SECSCH         &lt;dbl&gt; 1, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 0, 1, 1, …</code></pre>
</div>
</div>
<p>We can see that we have forgotten to remove Block and street. We can also check and confirm that all variables are in the right format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a>training_data <span class="ot">&lt;-</span> training_data <span class="sc">%&gt;%</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>block, <span class="sc">-</span>strt_nm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 998
Columns: 50
$ PRICE              &lt;dbl&gt; 682888.0, 695000.0, 658888.0, 748000.0, 790000.0, 7…
$ month              &lt;date&gt; 2023-01-01, 2023-01-01, 2023-01-01, 2023-02-01, 20…
$ block              &lt;chr&gt; "306", "306", "402", "431", "259", "259", "176", "6…
$ strt_nm            &lt;chr&gt; "ANG MO KIO AVE 1", "ANG MO KIO AVE 1", "ANG MO KIO…
$ AREA_SQM           &lt;dbl&gt; 123, 123, 119, 119, 135, 135, 119, 133, 135, 118, 1…
$ REMAINING_LEASE    &lt;dbl&gt; 53.58, 53.58, 55.42, 54.92, 58.42, 58.17, 69.33, 72…
$ Stry_Or            &lt;dbl&gt; 6, 2, 4, 8, 5, 1, 2, 5, 4, 7, 7, 4, 2, 3, 3, 1, 2, …
$ Improvd            &lt;dbl&gt; 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, …
$ NwGnrtn            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ DBSS               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Standrd            &lt;dbl&gt; 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Aprtmnt            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Simplfd            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Model.A            &lt;dbl&gt; 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 1, 1, 0, 0, …
$ PrmmApr            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Adjndfl            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ MdlA.Ms            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Maisntt            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Type.S1            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Type.S2            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ ModelA2            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Terrace            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Imprv.M            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ PrmmMsn            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ MltGnrt            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ PrmmApL            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ X2.room            &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ X3Gen              &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ PROX_CBD           &lt;dbl&gt; 8625.861, 8625.861, 8139.329, 8876.533, 9195.256, 9…
$ PROX_BUS           &lt;dbl&gt; 178.81652, 178.81652, 118.76102, 197.29080, 84.2301…
$ PROX_CLUBS         &lt;dbl&gt; 578.73029, 578.73029, 265.15993, 546.71811, 832.788…
$ PROX_ELDERCARE     &lt;dbl&gt; 211.9637, 211.9637, 367.6850, 356.4709, 501.9017, 5…
$ PROX_FAM           &lt;dbl&gt; 940.0572, 940.0572, 612.9699, 319.3456, 706.0581, 7…
$ PROX_MRT           &lt;dbl&gt; 573.2417, 573.2417, 1065.8815, 365.2200, 1981.5890,…
$ PROX_HAWKER        &lt;dbl&gt; 331.2628, 331.2628, 143.0536, 375.3304, 508.2023, 5…
$ PROX_KINDERGARTENS &lt;dbl&gt; 188.26098, 188.26098, 518.63595, 148.88003, 450.529…
$ PROX_PHARMACY      &lt;dbl&gt; 488.5421, 488.5421, 1152.5507, 522.2008, 1540.0063,…
$ PROX_PARK          &lt;dbl&gt; 554.3174, 554.3174, 537.1188, 390.1731, 294.0396, 2…
$ PROX_MALL          &lt;dbl&gt; 490.9497, 490.9497, 1145.3444, 514.1228, 1582.3113,…
$ PROX_SPRMKT        &lt;dbl&gt; 246.50070, 246.50070, 504.07157, 313.59260, 541.623…
$ PROX_CHILDCARE     &lt;dbl&gt; 1.580294e+02, 1.580294e+02, 3.274622e+02, 1.488800e…
$ PROX_PRISCH        &lt;dbl&gt; 585.34956, 585.34956, 240.18714, 358.85813, 899.237…
$ PROX_GOODP         &lt;dbl&gt; 5325.218, 5325.218, 4880.120, 5632.979, 5155.426, 5…
$ PROX_SECSCH        &lt;dbl&gt; 438.0324, 438.0324, 586.3205, 250.5094, 259.7381, 2…
$ geometry           &lt;POINT [m]&gt; POINT (29383.53 38640.51), POINT (29383.53 38…
$ NUM_KNDRGTN        &lt;dbl&gt; 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 2, 1, 1, 1, 1, 1, 1, …
$ NUM_CHILDCARE      &lt;dbl&gt; 6, 6, 1, 4, 2, 2, 3, 5, 5, 4, 8, 4, 3, 3, 2, 6, 3, …
$ NUM_BUS_STOP       &lt;dbl&gt; 6, 6, 7, 6, 6, 6, 6, 8, 10, 6, 8, 10, 11, 11, 10, 5…
$ NUM_PRISCH         &lt;dbl&gt; 3, 3, 2, 3, 3, 3, 2, 2, 2, 2, 3, 3, 3, 3, 2, 2, 3, …
$ NUM_SECSCH         &lt;dbl&gt; 2, 2, 1, 2, 2, 2, 3, 2, 2, 2, 3, 4, 3, 3, 3, 2, 1, …</code></pre>
</div>
</div>
<p>We can see that we have forgotten to remove Block and street. We can also check and confirm that all variables are in the right format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> test_data <span class="sc">%&gt;%</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>block, <span class="sc">-</span>strt_nm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="computing-correlation-matrix" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Computing Correlation Matrix</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a>training_data_nogeo <span class="ot">&lt;-</span> training_data <span class="sc">%&gt;%</span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will first create the correlation matrix and check for any NA or infinite values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>cor_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(training_data_nogeo[,<span class="dv">3</span><span class="sc">:</span><span class="dv">47</span>])</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.na</span>(cor_matrix)) <span class="co"># check for missing values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">any</span>(<span class="fu">is.infinite</span>(cor_matrix)) <span class="co"># check for infinite values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>Since there are missing values, we will fix this by assigning 0 to them</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>na_value <span class="ot">&lt;-</span> <span class="fu">is.na</span>(cor_matrix)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>cor_matrix[na_value] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(cor_matrix, </span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">diag =</span> <span class="cn">FALSE</span>, </span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">order =</span> <span class="st">"AOE"</span>,</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.pos =</span> <span class="st">"td"</span>, </span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">tl.cex =</span> <span class="fl">0.2</span>, </span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"number"</span>, </span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">"upper"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-136-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see several correlated variables above 0.5 but they are within acceptable range to be included in the regression. However, it would be better to remove PROX_KINDERGARTENS, PROX_CHILDCARE, PROX_BUS, PROX_PRISCH and PROX_SECSCH. This is because the effects from these 5 variables would have been captured in the facility count, NUM_ . While the correlation matrix suggest no high correlation, it could create bias in our estimator should the variables be correlated.</p>
</section>
<section id="building-a-non-spatial-multiple-linear-regression" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Building a non-spatial multiple linear regression</h1>
<p>We will run the multiple linear regression using the base R function, lm().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>price_mlr1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(PRICE <span class="sc">~</span> AREA_SQM <span class="sc">+</span> REMAINING_LEASE <span class="sc">+</span> Stry_Or <span class="sc">+</span> Improvd <span class="sc">+</span> DBSS <span class="sc">+</span> Standrd <span class="sc">+</span> Model.A <span class="sc">+</span> PrmmApr <span class="sc">+</span> Adjndfl <span class="sc">+</span> MdlA.Ms <span class="sc">+</span> Type.S2 <span class="sc">+</span> Imprv.M <span class="sc">+</span> PrmmApL <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_CLUBS <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_FAM <span class="sc">+</span> PROX_MRT <span class="sc">+</span>PROX_HAWKER <span class="sc">+</span> PROX_PHARMACY <span class="sc">+</span>PROX_PARK<span class="sc">+</span>PROX_MALL <span class="sc">+</span> PROX_SPRMKT <span class="sc">+</span> PROX_GOODP <span class="sc">+</span> NUM_KNDRGTN <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_BUS_STOP <span class="sc">+</span> NUM_PRISCH <span class="sc">+</span> NUM_SECSCH,</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> training_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can first save the model by running the code chunk below.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(price_mlr1, <span class="st">"data/model/price_mlr1.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>price_mlr1 <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/price_mlr1.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="understanding-the-non-spatial-multiple-linear-regression-model" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="understanding-the-non-spatial-multiple-linear-regression-model"><span class="header-section-number">8.1</span> Understanding the non-spatial multiple linear regression model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(price_mlr1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = PRICE ~ AREA_SQM + REMAINING_LEASE + Stry_Or + Improvd + 
    DBSS + Standrd + Model.A + PrmmApr + Adjndfl + MdlA.Ms + 
    Type.S2 + Imprv.M + PrmmApL + PROX_CBD + PROX_CLUBS + PROX_ELDERCARE + 
    PROX_FAM + PROX_MRT + PROX_HAWKER + PROX_PHARMACY + PROX_PARK + 
    PROX_MALL + PROX_SPRMKT + PROX_GOODP + NUM_KNDRGTN + NUM_CHILDCARE + 
    NUM_BUS_STOP + NUM_PRISCH + NUM_SECSCH, data = training_data)

Residuals:
    Min      1Q  Median      3Q     Max 
-259902  -50073   -2595   45960  697099 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -3.188e+05  4.201e+04  -7.589 3.41e-14 ***
AREA_SQM         6.767e+03  1.547e+02  43.734  &lt; 2e-16 ***
REMAINING_LEASE  5.948e+03  9.011e+01  66.007  &lt; 2e-16 ***
Stry_Or          1.818e+04  3.270e+02  55.610  &lt; 2e-16 ***
Improvd         -1.097e+04  3.426e+04  -0.320 0.748883    
DBSS             1.460e+05  3.447e+04   4.236 2.29e-05 ***
Standrd          4.393e+04  3.451e+04   1.273 0.203118    
Model.A         -4.312e+04  3.438e+04  -1.254 0.209755    
PrmmApr         -5.752e+03  3.428e+04  -0.168 0.866730    
Adjndfl         -1.602e+04  3.622e+04  -0.442 0.658292    
MdlA.Ms          1.366e+04  3.502e+04   0.390 0.696473    
Type.S2          1.642e+05  3.571e+04   4.598 4.30e-06 ***
Imprv.M          9.382e+03  4.841e+04   0.194 0.846324    
PrmmApL          1.838e+05  4.367e+04   4.208 2.59e-05 ***
PROX_CBD        -1.948e+01  2.567e-01 -75.884  &lt; 2e-16 ***
PROX_CLUBS       2.202e+01  2.801e+00   7.860 4.10e-15 ***
PROX_ELDERCARE   5.401e+00  1.143e+00   4.726 2.31e-06 ***
PROX_FAM        -3.407e+01  1.396e+00 -24.397  &lt; 2e-16 ***
PROX_MRT        -9.855e+00  1.898e+00  -5.193 2.09e-07 ***
PROX_HAWKER     -2.967e+01  1.417e+00 -20.946  &lt; 2e-16 ***
PROX_PHARMACY   -8.325e+00  2.463e+00  -3.380 0.000728 ***
PROX_PARK        1.550e+01  1.666e+00   9.301  &lt; 2e-16 ***
PROX_MALL       -2.494e+01  2.236e+00 -11.152  &lt; 2e-16 ***
PROX_SPRMKT     -2.795e+01  4.367e+00  -6.400 1.61e-10 ***
PROX_GOODP      -4.158e-01  2.891e-01  -1.438 0.150363    
NUM_KNDRGTN      1.060e+04  7.090e+02  14.949  &lt; 2e-16 ***
NUM_CHILDCARE   -5.565e+03  3.491e+02 -15.940  &lt; 2e-16 ***
NUM_BUS_STOP    -1.417e+02  2.304e+02  -0.615 0.538627    
NUM_PRISCH      -1.068e+04  5.255e+02 -20.319  &lt; 2e-16 ***
NUM_SECSCH      -2.021e+03  6.474e+02  -3.122 0.001798 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 76410 on 14478 degrees of freedom
Multiple R-squared:  0.7271,    Adjusted R-squared:  0.7266 
F-statistic:  1330 on 29 and 14478 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>We can visualise the regression as a table by using gtsummary package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>gtsummary<span class="sc">::</span><span class="fu">tbl_regression</span>(price_mlr1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="xqqjtfyhpt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

:where(#xqqjtfyhpt) .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

:where(#xqqjtfyhpt) .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#xqqjtfyhpt) .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

:where(#xqqjtfyhpt) .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

:where(#xqqjtfyhpt) .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

:where(#xqqjtfyhpt) .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#xqqjtfyhpt) .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

:where(#xqqjtfyhpt) .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

:where(#xqqjtfyhpt) .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

:where(#xqqjtfyhpt) .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

:where(#xqqjtfyhpt) .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

:where(#xqqjtfyhpt) .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

:where(#xqqjtfyhpt) .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

:where(#xqqjtfyhpt) .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

:where(#xqqjtfyhpt) .gt_from_md > :first-child {
  margin-top: 0;
}

:where(#xqqjtfyhpt) .gt_from_md > :last-child {
  margin-bottom: 0;
}

:where(#xqqjtfyhpt) .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

:where(#xqqjtfyhpt) .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#xqqjtfyhpt) .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

:where(#xqqjtfyhpt) .gt_row_group_first td {
  border-top-width: 2px;
}

:where(#xqqjtfyhpt) .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#xqqjtfyhpt) .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

:where(#xqqjtfyhpt) .gt_first_summary_row.thick {
  border-top-width: 2px;
}

:where(#xqqjtfyhpt) .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#xqqjtfyhpt) .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#xqqjtfyhpt) .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

:where(#xqqjtfyhpt) .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

:where(#xqqjtfyhpt) .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

:where(#xqqjtfyhpt) .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#xqqjtfyhpt) .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#xqqjtfyhpt) .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

:where(#xqqjtfyhpt) .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

:where(#xqqjtfyhpt) .gt_left {
  text-align: left;
}

:where(#xqqjtfyhpt) .gt_center {
  text-align: center;
}

:where(#xqqjtfyhpt) .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

:where(#xqqjtfyhpt) .gt_font_normal {
  font-weight: normal;
}

:where(#xqqjtfyhpt) .gt_font_bold {
  font-weight: bold;
}

:where(#xqqjtfyhpt) .gt_font_italic {
  font-style: italic;
}

:where(#xqqjtfyhpt) .gt_super {
  font-size: 65%;
}

:where(#xqqjtfyhpt) .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

:where(#xqqjtfyhpt) .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

:where(#xqqjtfyhpt) .gt_indent_1 {
  text-indent: 5px;
}

:where(#xqqjtfyhpt) .gt_indent_2 {
  text-indent: 10px;
}

:where(#xqqjtfyhpt) .gt_indent_3 {
  text-indent: 15px;
}

:where(#xqqjtfyhpt) .gt_indent_4 {
  text-indent: 20px;
}

:where(#xqqjtfyhpt) .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="<strong>Characteristic</strong>"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>Beta</strong>"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>95% CI</strong><sup class=&quot;gt_footnote_marks&quot;>1</sup>"><strong>95% CI</strong><sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="<strong>p-value</strong>"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left">AREA_SQM</td>
<td headers="estimate" class="gt_row gt_center">6,767</td>
<td headers="ci" class="gt_row gt_center">6,464, 7,071</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">REMAINING_LEASE</td>
<td headers="estimate" class="gt_row gt_center">5,948</td>
<td headers="ci" class="gt_row gt_center">5,771, 6,125</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Stry_Or</td>
<td headers="estimate" class="gt_row gt_center">18,183</td>
<td headers="ci" class="gt_row gt_center">17,542, 18,824</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Improvd</td>
<td headers="estimate" class="gt_row gt_center">-10,966</td>
<td headers="ci" class="gt_row gt_center">-78,114, 56,182</td>
<td headers="p.value" class="gt_row gt_center">0.7</td></tr>
    <tr><td headers="label" class="gt_row gt_left">DBSS</td>
<td headers="estimate" class="gt_row gt_center">146,011</td>
<td headers="ci" class="gt_row gt_center">78,446, 213,575</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Standrd</td>
<td headers="estimate" class="gt_row gt_center">43,929</td>
<td headers="ci" class="gt_row gt_center">-23,724, 111,582</td>
<td headers="p.value" class="gt_row gt_center">0.2</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Model.A</td>
<td headers="estimate" class="gt_row gt_center">-43,118</td>
<td headers="ci" class="gt_row gt_center">-110,500, 24,264</td>
<td headers="p.value" class="gt_row gt_center">0.2</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PrmmApr</td>
<td headers="estimate" class="gt_row gt_center">-5,752</td>
<td headers="ci" class="gt_row gt_center">-72,940, 61,435</td>
<td headers="p.value" class="gt_row gt_center">0.9</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Adjndfl</td>
<td headers="estimate" class="gt_row gt_center">-16,019</td>
<td headers="ci" class="gt_row gt_center">-87,011, 54,974</td>
<td headers="p.value" class="gt_row gt_center">0.7</td></tr>
    <tr><td headers="label" class="gt_row gt_left">MdlA.Ms</td>
<td headers="estimate" class="gt_row gt_center">13,661</td>
<td headers="ci" class="gt_row gt_center">-54,984, 82,307</td>
<td headers="p.value" class="gt_row gt_center">0.7</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Type.S2</td>
<td headers="estimate" class="gt_row gt_center">164,201</td>
<td headers="ci" class="gt_row gt_center">94,207, 234,196</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">Imprv.M</td>
<td headers="estimate" class="gt_row gt_center">9,382</td>
<td headers="ci" class="gt_row gt_center">-85,505, 104,270</td>
<td headers="p.value" class="gt_row gt_center">0.8</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PrmmApL</td>
<td headers="estimate" class="gt_row gt_center">183,756</td>
<td headers="ci" class="gt_row gt_center">98,165, 269,348</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_CBD</td>
<td headers="estimate" class="gt_row gt_center">-19</td>
<td headers="ci" class="gt_row gt_center">-20, -19</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_CLUBS</td>
<td headers="estimate" class="gt_row gt_center">22</td>
<td headers="ci" class="gt_row gt_center">17, 28</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_ELDERCARE</td>
<td headers="estimate" class="gt_row gt_center">5.4</td>
<td headers="ci" class="gt_row gt_center">3.2, 7.6</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_FAM</td>
<td headers="estimate" class="gt_row gt_center">-34</td>
<td headers="ci" class="gt_row gt_center">-37, -31</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_MRT</td>
<td headers="estimate" class="gt_row gt_center">-9.9</td>
<td headers="ci" class="gt_row gt_center">-14, -6.1</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_HAWKER</td>
<td headers="estimate" class="gt_row gt_center">-30</td>
<td headers="ci" class="gt_row gt_center">-32, -27</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_PHARMACY</td>
<td headers="estimate" class="gt_row gt_center">-8.3</td>
<td headers="ci" class="gt_row gt_center">-13, -3.5</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_PARK</td>
<td headers="estimate" class="gt_row gt_center">15</td>
<td headers="ci" class="gt_row gt_center">12, 19</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_MALL</td>
<td headers="estimate" class="gt_row gt_center">-25</td>
<td headers="ci" class="gt_row gt_center">-29, -21</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_SPRMKT</td>
<td headers="estimate" class="gt_row gt_center">-28</td>
<td headers="ci" class="gt_row gt_center">-37, -19</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">PROX_GOODP</td>
<td headers="estimate" class="gt_row gt_center">-0.42</td>
<td headers="ci" class="gt_row gt_center">-0.98, 0.15</td>
<td headers="p.value" class="gt_row gt_center">0.2</td></tr>
    <tr><td headers="label" class="gt_row gt_left">NUM_KNDRGTN</td>
<td headers="estimate" class="gt_row gt_center">10,599</td>
<td headers="ci" class="gt_row gt_center">9,209, 11,989</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">NUM_CHILDCARE</td>
<td headers="estimate" class="gt_row gt_center">-5,565</td>
<td headers="ci" class="gt_row gt_center">-6,249, -4,881</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">NUM_BUS_STOP</td>
<td headers="estimate" class="gt_row gt_center">-142</td>
<td headers="ci" class="gt_row gt_center">-593, 310</td>
<td headers="p.value" class="gt_row gt_center">0.5</td></tr>
    <tr><td headers="label" class="gt_row gt_left">NUM_PRISCH</td>
<td headers="estimate" class="gt_row gt_center">-10,677</td>
<td headers="ci" class="gt_row gt_center">-11,707, -9,647</td>
<td headers="p.value" class="gt_row gt_center">&lt;0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left">NUM_SECSCH</td>
<td headers="estimate" class="gt_row gt_center">-2,021</td>
<td headers="ci" class="gt_row gt_center">-3,290, -752</td>
<td headers="p.value" class="gt_row gt_center">0.002</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><sup class="gt_footnote_marks">1</sup> CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
</div>
</div>
<p>From the multiple linear regression model above, we notice that adjusted R square is at 0.7266. This suggest that the model can explain 0.7266 of the variation in Resale Price. We also notice that majority of the proximity variables are significant at the 1% level. This can also be said for AREASQM, REMAINING LEASE AND STORY OR. The model of the apartment did not have significant impact on the Resale Price. However, two model type, DBSS and Type.S2 are significant.</p>
</section>
<section id="calculating-predictive-error" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="calculating-predictive-error"><span class="header-section-number">8.2</span> Calculating predictive error</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>lm_predicted_value <span class="ot">&lt;-</span> <span class="fu">predict.lm</span>(price_mlr1, <span class="at">newdata =</span> test_data)</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate MSE</span></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> <span class="fu">mean</span>((test_data<span class="sc">$</span>PRICE <span class="sc">-</span> lm_predicted_value)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a>rmse_lm <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(MSE)</span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>rmse_lm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 87822.93</code></pre>
</div>
</div>
<p>From the square-root of the mean square error is 87822.93. We will take note of this value in the later parts of the regression modelling.</p>
<p>We can compare models using Akaike information criterion (AIC). The smaller the AIC, the better the model. We will find the AIC by running the code chunk below.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(price_mlr1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 367455.5</code></pre>
</div>
</div>
<p>We will just take note of this number and move along with the other models.</p>
</section>
</section>
<section id="gwr-predictive-method" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> GWR Predictive Method</h1>
<section id="converting-sf-dataframe-to-spatialpointdataframe" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="converting-sf-dataframe-to-spatialpointdataframe"><span class="header-section-number">9.1</span> Converting sf dataframe to SpatialPointDataframe</h2>
<p>First, we will need to change the training dataframe into a Spatial point data frame. This is used to calculate the other sections in this portion of the Exercise.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>train_data_sp <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(training_data)</span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>train_data_sp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>class       : SpatialPointsDataFrame 
features    : 14508 
extent      : 6958.193, 42645.18, 28157.26, 48741.06  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 47
names       :   PRICE, month, AREA_SQM, REMAINING_LEASE, Stry_Or, Improvd, NwGnrtn, DBSS, Standrd, Aprtmnt, Simplfd, Model.A, PrmmApr, Adjndfl, MdlA.Ms, ... 
min values  :  350000, 18628,       99,           49.08,       1,       0,       0,    0,       0,       0,       0,       0,       0,       0,       0, ... 
max values  : 1418000, 19327,      167,           96.75,      17,       1,       0,    1,       1,       0,       0,       1,       1,       1,       1, ... </code></pre>
</div>
</div>
</section>
<section id="finding-optimal-adaptive-bandwidth" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="finding-optimal-adaptive-bandwidth"><span class="header-section-number">9.2</span> Finding optimal adaptive bandwidth</h2>
<p>We will find the optimal adaptive bandwidth of the geospatial weighted regression. The code chunk below uses bw.gwr() from the GWModel package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>bw_adaptive <span class="ot">&lt;-</span> <span class="fu">bw.gwr</span>(PRICE <span class="sc">~</span> AREA_SQM <span class="sc">+</span> REMAINING_LEASE <span class="sc">+</span> Stry_Or <span class="sc">+</span> Improvd <span class="sc">+</span> DBSS <span class="sc">+</span> Standrd <span class="sc">+</span> Model.A <span class="sc">+</span> PrmmApr <span class="sc">+</span> Adjndfl <span class="sc">+</span> MdlA.Ms <span class="sc">+</span> Type.S2 <span class="sc">+</span> Imprv.M <span class="sc">+</span> PrmmApL <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_CLUBS <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_FAM <span class="sc">+</span> PROX_MRT <span class="sc">+</span>PROX_HAWKER <span class="sc">+</span> PROX_PHARMACY <span class="sc">+</span>PROX_PARK<span class="sc">+</span>PROX_MALL <span class="sc">+</span> PROX_SPRMKT <span class="sc">+</span> PROX_GOODP <span class="sc">+</span> NUM_KNDRGTN <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_BUS_STOP <span class="sc">+</span> NUM_PRISCH <span class="sc">+</span> NUM_SECSCH,</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> train_data_sp,</span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">approach=</span><span class="st">"CV"</span>,</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">kernel=</span><span class="st">"gaussian"</span>,</span>
<span id="cb216-5"><a href="#cb216-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">adaptive=</span><span class="cn">TRUE</span>,</span>
<span id="cb216-6"><a href="#cb216-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">longlat=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/image-1232532573.png" class="img-fluid"></p>
<p>The smallest CV score is adaptive bandwidth: 1005.</p>
<p>We will save the adaptive bandwidth as an RDS file for easy retrieval.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(bw_adaptive, <span class="at">file =</span> <span class="st">"data/model/bw_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="constructing-the-adaptive-bandwidth-gwr" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="constructing-the-adaptive-bandwidth-gwr"><span class="header-section-number">9.3</span> Constructing the adaptive bandwidth GWR</h2>
<p>We will retrieve the adaptive bandwidth by using read_rds from the readr package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>bw_adaptive <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/bw_adaptive.rds"</span>)</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>bw_adaptive</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1005</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive <span class="ot">&lt;-</span> <span class="fu">gwr.basic</span>(<span class="at">formula =</span> PRICE <span class="sc">~</span> AREA_SQM <span class="sc">+</span> REMAINING_LEASE <span class="sc">+</span> Stry_Or <span class="sc">+</span> Improvd <span class="sc">+</span> DBSS <span class="sc">+</span> Standrd <span class="sc">+</span> Model.A <span class="sc">+</span> PrmmApr <span class="sc">+</span> Adjndfl <span class="sc">+</span> MdlA.Ms <span class="sc">+</span> Type.S2 <span class="sc">+</span> Imprv.M <span class="sc">+</span> PrmmApL <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_CLUBS <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_FAM <span class="sc">+</span> PROX_MRT <span class="sc">+</span>PROX_HAWKER <span class="sc">+</span> PROX_PHARMACY <span class="sc">+</span>PROX_PARK<span class="sc">+</span>PROX_MALL <span class="sc">+</span> PROX_SPRMKT <span class="sc">+</span> PROX_GOODP <span class="sc">+</span> NUM_KNDRGTN <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_BUS_STOP <span class="sc">+</span> NUM_PRISCH <span class="sc">+</span> NUM_SECSCH,</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> train_data_sp,</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">bw=</span>bw_adaptive, </span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">'gaussian'</span>, </span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a>                          <span class="at">adaptive=</span><span class="cn">TRUE</span>,</span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">longlat =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Again we will save the the regression model as an rds file.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwr_adaptive, <span class="st">"data/model/gwr_adaptive.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>gwr_adaptive <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/gwr_adaptive.rds"</span>)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>gwr_adaptive</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   ***********************************************************************
   *                       Package   GWmodel                             *
   ***********************************************************************
   Program starts at: 2023-03-17 12:49:34 
   Call:
   gwr.basic(formula = PRICE ~ AREA_SQM + REMAINING_LEASE + Stry_Or + 
    Improvd + DBSS + Standrd + Model.A + PrmmApr + Adjndfl + 
    MdlA.Ms + Type.S2 + Imprv.M + PrmmApL + PROX_CBD + PROX_CLUBS + 
    PROX_ELDERCARE + PROX_FAM + PROX_MRT + PROX_HAWKER + PROX_PHARMACY + 
    PROX_PARK + PROX_MALL + PROX_SPRMKT + PROX_GOODP + NUM_KNDRGTN + 
    NUM_CHILDCARE + NUM_BUS_STOP + NUM_PRISCH + NUM_SECSCH, data = train_data_sp, 
    bw = bw_adaptive, kernel = "gaussian", adaptive = TRUE, longlat = FALSE)

   Dependent (y) variable:  PRICE
   Independent variables:  AREA_SQM REMAINING_LEASE Stry_Or Improvd DBSS Standrd Model.A PrmmApr Adjndfl MdlA.Ms Type.S2 Imprv.M PrmmApL PROX_CBD PROX_CLUBS PROX_ELDERCARE PROX_FAM PROX_MRT PROX_HAWKER PROX_PHARMACY PROX_PARK PROX_MALL PROX_SPRMKT PROX_GOODP NUM_KNDRGTN NUM_CHILDCARE NUM_BUS_STOP NUM_PRISCH NUM_SECSCH
   Number of data points: 14508
   ***********************************************************************
   *                    Results of Global Regression                     *
   ***********************************************************************

   Call:
    lm(formula = formula, data = data)

   Residuals:
    Min      1Q  Median      3Q     Max 
-259902  -50073   -2595   45960  697099 

   Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
   (Intercept)     -3.188e+05  4.201e+04  -7.589 3.41e-14 ***
   AREA_SQM         6.767e+03  1.547e+02  43.734  &lt; 2e-16 ***
   REMAINING_LEASE  5.948e+03  9.011e+01  66.007  &lt; 2e-16 ***
   Stry_Or          1.818e+04  3.270e+02  55.610  &lt; 2e-16 ***
   Improvd         -1.097e+04  3.426e+04  -0.320 0.748883    
   DBSS             1.460e+05  3.447e+04   4.236 2.29e-05 ***
   Standrd          4.393e+04  3.451e+04   1.273 0.203118    
   Model.A         -4.312e+04  3.438e+04  -1.254 0.209755    
   PrmmApr         -5.752e+03  3.428e+04  -0.168 0.866730    
   Adjndfl         -1.602e+04  3.622e+04  -0.442 0.658292    
   MdlA.Ms          1.366e+04  3.502e+04   0.390 0.696473    
   Type.S2          1.642e+05  3.571e+04   4.598 4.30e-06 ***
   Imprv.M          9.382e+03  4.841e+04   0.194 0.846324    
   PrmmApL          1.838e+05  4.367e+04   4.208 2.59e-05 ***
   PROX_CBD        -1.948e+01  2.567e-01 -75.884  &lt; 2e-16 ***
   PROX_CLUBS       2.202e+01  2.801e+00   7.860 4.10e-15 ***
   PROX_ELDERCARE   5.401e+00  1.143e+00   4.726 2.31e-06 ***
   PROX_FAM        -3.407e+01  1.396e+00 -24.397  &lt; 2e-16 ***
   PROX_MRT        -9.855e+00  1.898e+00  -5.193 2.09e-07 ***
   PROX_HAWKER     -2.967e+01  1.417e+00 -20.946  &lt; 2e-16 ***
   PROX_PHARMACY   -8.325e+00  2.463e+00  -3.380 0.000728 ***
   PROX_PARK        1.550e+01  1.666e+00   9.301  &lt; 2e-16 ***
   PROX_MALL       -2.494e+01  2.236e+00 -11.152  &lt; 2e-16 ***
   PROX_SPRMKT     -2.795e+01  4.367e+00  -6.400 1.61e-10 ***
   PROX_GOODP      -4.158e-01  2.891e-01  -1.438 0.150363    
   NUM_KNDRGTN      1.060e+04  7.090e+02  14.949  &lt; 2e-16 ***
   NUM_CHILDCARE   -5.565e+03  3.491e+02 -15.940  &lt; 2e-16 ***
   NUM_BUS_STOP    -1.417e+02  2.304e+02  -0.615 0.538627    
   NUM_PRISCH      -1.068e+04  5.255e+02 -20.319  &lt; 2e-16 ***
   NUM_SECSCH      -2.021e+03  6.474e+02  -3.122 0.001798 ** 

   ---Significance stars
   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
   Residual standard error: 76410 on 14478 degrees of freedom
   Multiple R-squared: 0.7271
   Adjusted R-squared: 0.7266 
   F-statistic:  1330 on 29 and 14478 DF,  p-value: &lt; 2.2e-16 
   ***Extra Diagnostic information
   Residual sum of squares: 8.452677e+13
   Sigma(hat): 76334.93
   AIC:  367455.5
   AICc:  367455.6
   BIC:  353479.6
   ***********************************************************************
   *          Results of Geographically Weighted Regression              *
   ***********************************************************************

   *********************Model calibration information*********************
   Kernel function: gaussian 
   Adaptive bandwidth: 1005 (number of nearest neighbours)
   Regression points: the same locations as observations are used.
   Distance metric: Euclidean distance metric is used.

   ****************Summary of GWR coefficient estimates:******************
                          Min.     1st Qu.      Median     3rd Qu.       Max.
   Intercept       -1.4548e+06 -4.6710e+05 -2.0784e+05  2.4157e+05 1.2847e+06
   AREA_SQM         1.6145e+03  3.2348e+03  4.3778e+03  6.6833e+03 8.6631e+03
   REMAINING_LEASE  4.0905e+03  4.9922e+03  6.1387e+03  7.5314e+03 8.4507e+03
   Stry_Or          1.1268e+04  1.2476e+04  1.4096e+04  1.6576e+04 2.0459e+04
   Improvd         -1.2065e+06 -8.8499e+04 -3.3776e+04 -1.2356e+04 1.5452e+06
   DBSS            -9.5731e+05  2.1606e+04  7.3551e+04  1.4708e+05 1.6717e+06
   Standrd         -1.1824e+06 -7.9719e+04  6.2211e+03  5.8653e+04 1.4791e+06
   Model.A         -1.2495e+06 -1.0097e+05 -5.6049e+04  3.3346e+03 1.4964e+06
   PrmmApr         -1.2176e+06 -9.7368e+04 -1.8598e+04  9.5304e+03 1.4993e+06
   Adjndfl         -1.2663e+06 -5.0473e+04 -1.7153e+04  8.0498e+04 1.5347e+06
   MdlA.Ms         -1.1110e+06 -2.5896e+04  2.7910e+04  9.8371e+04 1.5996e+06
   Type.S2         -9.1354e+05  1.0022e+05  1.6488e+05  2.8107e+05 1.8472e+06
   Imprv.M         -1.0816e+06 -3.3876e+04  5.7395e+03  1.0804e+05 6.4574e+07
   PrmmApL         -7.8590e+05  1.5875e+05  1.7764e+05  2.1128e+05 1.8828e+06
   PROX_CBD        -3.9344e+01 -2.1491e+01 -1.8859e+01 -8.4149e+00 1.7230e+01
   PROX_CLUBS      -5.4932e+01 -2.1079e+01 -7.5242e+00  1.1215e+01 6.2743e+01
   PROX_ELDERCARE  -3.1435e+01 -1.2876e+01 -3.3125e+00  7.4618e+00 4.1139e+01
   PROX_FAM        -7.8119e+01 -3.7425e+01 -2.5234e+01 -3.3249e+00 3.1072e+01
   PROX_MRT        -1.3562e+02 -3.4614e+01 -1.8085e+01 -5.4282e-01 2.3095e+01
   PROX_HAWKER     -7.2563e+01 -2.2956e+01 -9.0648e+00 -6.3781e-01 3.8439e+01
   PROX_PHARMACY   -1.0591e+02 -3.2867e+01 -2.3136e+01 -1.3933e+00 1.0106e+02
   PROX_PARK       -4.3781e+01 -1.4518e+01 -6.3276e+00  6.3055e+00 3.9140e+01
   PROX_MALL       -7.8253e+01 -3.6393e+01 -6.5437e+00  1.2115e+01 4.6891e+01
   PROX_SPRMKT     -1.3570e+02 -5.9855e+01 -2.7766e+01 -8.0718e-02 4.6203e+01
   PROX_GOODP      -4.4953e+01 -1.2628e+01  8.2561e-01  9.0486e+00 3.4615e+01
   NUM_KNDRGTN     -1.4397e+04 -1.3103e+03  4.0995e+03  1.1081e+04 2.2052e+04
   NUM_CHILDCARE   -9.6929e+03 -4.5376e+03 -2.9498e+03 -1.5745e+03 1.8159e+03
   NUM_BUS_STOP    -2.8820e+03 -1.1841e+03  2.5732e+02  9.5197e+02 2.6178e+03
   NUM_PRISCH      -2.9142e+04 -6.9958e+03 -1.3525e+03  1.6400e+03 7.2517e+03
   NUM_SECSCH      -1.2541e+04 -2.0706e+03  2.6619e+02  3.1935e+03 2.6800e+04
   ************************Diagnostic information*************************
   Number of data points: 14508 
   Effective number of parameters (2trace(S) - trace(S'S)): 232.3903 
   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 14275.61 
   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 360210.2 
   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 360019.7 
   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 347088.5 
   Residual sum of squares: 5.020664e+13 
   R-square value:  0.8379075 
   Adjusted R-square value:  0.8352687 

   ***********************************************************************
   Program stops at: 2023-03-17 12:52:21 </code></pre>
</div>
</div>
<p>From the output above, we see that Adjusted R-square is 0.8352, higher than the non-spatial mulitiple linear regression model.</p>
</section>
<section id="preparing-coordinates-data" class="level2" data-number="9.4">
<h2 data-number="9.4" class="anchored" data-anchor-id="preparing-coordinates-data"><span class="header-section-number">9.4</span> Preparing coordinates data</h2>
<section id="extracting-coordinates-data" class="level3" data-number="9.4.1">
<h3 data-number="9.4.1" class="anchored" data-anchor-id="extracting-coordinates-data"><span class="header-section-number">9.4.1</span> Extracting coordinates data</h3>
<p>The code chunk below extract the x, y coordinates of the full, training and test data sets. This is as taught in in-class exercise 9.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>coords_train <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(training_data)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>coords_test <span class="ot">&lt;-</span> <span class="fu">st_coordinates</span>(test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Before we proceed, we should save the output into rds for future uses</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(coords_train, <span class="st">"data/model/coords_train.rds"</span> )</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(coords_test, <span class="st">"data/model/coords_test.rds"</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Afterwhich, we can just retrieve the coordinates from the saved files.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>coords_train <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/coords_train.rds"</span>)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>coords_test <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/coords_test.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="dropping-geometry-field" class="level3" data-number="9.4.2">
<h3 data-number="9.4.2" class="anchored" data-anchor-id="dropping-geometry-field"><span class="header-section-number">9.4.2</span> Dropping geometry field</h3>
<p>We need to drop the geometry column of the sf data.frame by using st_drop_geometry() of the sf package. This is because, in the later parts, we cannot have the geometry columns in the data when running the random forest model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>train_data_nogeo <span class="ot">&lt;-</span> training_data <span class="sc">%&gt;%</span></span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(train_data_nogeo, <span class="st">"data/model/train_data_nogeo.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>train_data_nogeo <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/train_data_nogeo.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="calibrating-random-forest-model" class="level2" data-number="9.5">
<h2 data-number="9.5" class="anchored" data-anchor-id="calibrating-random-forest-model"><span class="header-section-number">9.5</span> Calibrating Random Forest Model</h2>
<p>The code chunk below uses ranger() from the ranger package</p>
<p>This is done to calibrate the model, for predicting HDB resale prices.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>rf <span class="ot">&lt;-</span> <span class="fu">ranger</span>(PRICE <span class="sc">~</span> AREA_SQM <span class="sc">+</span> REMAINING_LEASE <span class="sc">+</span> Stry_Or <span class="sc">+</span> Improvd <span class="sc">+</span> DBSS <span class="sc">+</span> Standrd <span class="sc">+</span> Model.A <span class="sc">+</span> PrmmApr <span class="sc">+</span> Adjndfl <span class="sc">+</span> MdlA.Ms <span class="sc">+</span> Type.S2 <span class="sc">+</span> Imprv.M <span class="sc">+</span> PrmmApL <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_CLUBS <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_FAM <span class="sc">+</span> PROX_MRT <span class="sc">+</span>PROX_HAWKER <span class="sc">+</span> PROX_PHARMACY <span class="sc">+</span>PROX_PARK<span class="sc">+</span>PROX_MALL <span class="sc">+</span> PROX_SPRMKT <span class="sc">+</span> PROX_GOODP <span class="sc">+</span> NUM_KNDRGTN <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_BUS_STOP <span class="sc">+</span> NUM_PRISCH <span class="sc">+</span> NUM_SECSCH,</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> train_data_nogeo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(rf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ranger result

Call:
 ranger(PRICE ~ AREA_SQM + REMAINING_LEASE + Stry_Or + Improvd +      DBSS + Standrd + Model.A + PrmmApr + Adjndfl + MdlA.Ms +      Type.S2 + Imprv.M + PrmmApL + PROX_CBD + PROX_CLUBS + PROX_ELDERCARE +      PROX_FAM + PROX_MRT + PROX_HAWKER + PROX_PHARMACY + PROX_PARK +      PROX_MALL + PROX_SPRMKT + PROX_GOODP + NUM_KNDRGTN + NUM_CHILDCARE +      NUM_BUS_STOP + NUM_PRISCH + NUM_SECSCH, data = train_data_nogeo) 

Type:                             Regression 
Number of trees:                  500 
Sample size:                      14508 
Number of independent variables:  29 
Mtry:                             5 
Target node size:                 5 
Variable importance mode:         none 
Splitrule:                        variance 
OOB prediction error (MSE):       1836142422 
R squared (OOB):                  0.9140025 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a>gwRF_bw <span class="ot">&lt;-</span> <span class="fu">grf.bw</span>(<span class="at">formula =</span> PRICE <span class="sc">~</span> AREA_SQM <span class="sc">+</span> REMAINING_LEASE <span class="sc">+</span> Stry_Or <span class="sc">+</span> Improvd <span class="sc">+</span> DBSS <span class="sc">+</span> Standrd <span class="sc">+</span> Model.A <span class="sc">+</span> PrmmApr <span class="sc">+</span> Adjndfl <span class="sc">+</span> MdlA.Ms <span class="sc">+</span> Type.S2 <span class="sc">+</span> Imprv.M <span class="sc">+</span> PrmmApL <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_CLUBS <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_FAM <span class="sc">+</span> PROX_MRT <span class="sc">+</span>PROX_HAWKER <span class="sc">+</span> PROX_PHARMACY <span class="sc">+</span>PROX_PARK<span class="sc">+</span>PROX_MALL <span class="sc">+</span> PROX_SPRMKT <span class="sc">+</span> PROX_GOODP <span class="sc">+</span> NUM_KNDRGTN <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_BUS_STOP <span class="sc">+</span> NUM_PRISCH <span class="sc">+</span> NUM_SECSCH,</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> train_data_nogeo,</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">"adaptive"</span>,</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">trees =</span> <span class="dv">30</span>,</span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">coords =</span> coords_train</span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>                )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Due to long computational time, we will make do with what has been generated.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">725</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830196864620965</span></span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">726</span></span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831511354240713</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">727</span></span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.825814193350772</span></span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">728</span></span>
<span id="cb234-8"><a href="#cb234-8" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833117627936025</span></span>
<span id="cb234-9"><a href="#cb234-9" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">729</span></span>
<span id="cb234-10"><a href="#cb234-10" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831542049422668</span></span>
<span id="cb234-11"><a href="#cb234-11" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">730</span></span>
<span id="cb234-12"><a href="#cb234-12" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832690759328841</span></span>
<span id="cb234-13"><a href="#cb234-13" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">731</span></span>
<span id="cb234-14"><a href="#cb234-14" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831409189031434</span></span>
<span id="cb234-15"><a href="#cb234-15" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">732</span></span>
<span id="cb234-16"><a href="#cb234-16" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833478593806476</span></span>
<span id="cb234-17"><a href="#cb234-17" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">733</span></span>
<span id="cb234-18"><a href="#cb234-18" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828881217358686</span></span>
<span id="cb234-19"><a href="#cb234-19" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">734</span></span>
<span id="cb234-20"><a href="#cb234-20" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833837568289313</span></span>
<span id="cb234-21"><a href="#cb234-21" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">735</span></span>
<span id="cb234-22"><a href="#cb234-22" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830944546212957</span></span>
<span id="cb234-23"><a href="#cb234-23" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">736</span></span>
<span id="cb234-24"><a href="#cb234-24" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829109016792875</span></span>
<span id="cb234-25"><a href="#cb234-25" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">737</span></span>
<span id="cb234-26"><a href="#cb234-26" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832693746938043</span></span>
<span id="cb234-27"><a href="#cb234-27" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">738</span></span>
<span id="cb234-28"><a href="#cb234-28" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830609753683569</span></span>
<span id="cb234-29"><a href="#cb234-29" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">739</span></span>
<span id="cb234-30"><a href="#cb234-30" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828506606657883</span></span>
<span id="cb234-31"><a href="#cb234-31" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">740</span></span>
<span id="cb234-32"><a href="#cb234-32" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829942324327648</span></span>
<span id="cb234-33"><a href="#cb234-33" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">741</span></span>
<span id="cb234-34"><a href="#cb234-34" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829673050758191</span></span>
<span id="cb234-35"><a href="#cb234-35" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">742</span></span>
<span id="cb234-36"><a href="#cb234-36" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.834731888959398</span></span>
<span id="cb234-37"><a href="#cb234-37" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">743</span></span>
<span id="cb234-38"><a href="#cb234-38" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831271390847821</span></span>
<span id="cb234-39"><a href="#cb234-39" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">744</span></span>
<span id="cb234-40"><a href="#cb234-40" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830326788690227</span></span>
<span id="cb234-41"><a href="#cb234-41" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">745</span></span>
<span id="cb234-42"><a href="#cb234-42" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832112671503318</span></span>
<span id="cb234-43"><a href="#cb234-43" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">746</span></span>
<span id="cb234-44"><a href="#cb234-44" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832734247748836</span></span>
<span id="cb234-45"><a href="#cb234-45" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">747</span></span>
<span id="cb234-46"><a href="#cb234-46" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831818201150335</span></span>
<span id="cb234-47"><a href="#cb234-47" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">748</span></span>
<span id="cb234-48"><a href="#cb234-48" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831135316402252</span></span>
<span id="cb234-49"><a href="#cb234-49" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">749</span></span>
<span id="cb234-50"><a href="#cb234-50" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832132102303099</span></span>
<span id="cb234-51"><a href="#cb234-51" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">750</span></span>
<span id="cb234-52"><a href="#cb234-52" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.83134136735134</span></span>
<span id="cb234-53"><a href="#cb234-53" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">751</span></span>
<span id="cb234-54"><a href="#cb234-54" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.8306802097722</span></span>
<span id="cb234-55"><a href="#cb234-55" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">752</span></span>
<span id="cb234-56"><a href="#cb234-56" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829479547542639</span></span>
<span id="cb234-57"><a href="#cb234-57" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">753</span></span>
<span id="cb234-58"><a href="#cb234-58" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833479383819347</span></span>
<span id="cb234-59"><a href="#cb234-59" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">754</span></span>
<span id="cb234-60"><a href="#cb234-60" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.83099893981291</span></span>
<span id="cb234-61"><a href="#cb234-61" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">755</span></span>
<span id="cb234-62"><a href="#cb234-62" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830071154250661</span></span>
<span id="cb234-63"><a href="#cb234-63" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">756</span></span>
<span id="cb234-64"><a href="#cb234-64" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830529200273976</span></span>
<span id="cb234-65"><a href="#cb234-65" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">757</span></span>
<span id="cb234-66"><a href="#cb234-66" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831649054301567</span></span>
<span id="cb234-67"><a href="#cb234-67" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">758</span></span>
<span id="cb234-68"><a href="#cb234-68" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831735899098526</span></span>
<span id="cb234-69"><a href="#cb234-69" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">759</span></span>
<span id="cb234-70"><a href="#cb234-70" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830897778940034</span></span>
<span id="cb234-71"><a href="#cb234-71" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">760</span></span>
<span id="cb234-72"><a href="#cb234-72" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831347886646916</span></span>
<span id="cb234-73"><a href="#cb234-73" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">761</span></span>
<span id="cb234-74"><a href="#cb234-74" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828948414511987</span></span>
<span id="cb234-75"><a href="#cb234-75" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">762</span></span>
<span id="cb234-76"><a href="#cb234-76" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831341467830645</span></span>
<span id="cb234-77"><a href="#cb234-77" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">763</span></span>
<span id="cb234-78"><a href="#cb234-78" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830232601893768</span></span>
<span id="cb234-79"><a href="#cb234-79" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">764</span></span>
<span id="cb234-80"><a href="#cb234-80" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831059678585006</span></span>
<span id="cb234-81"><a href="#cb234-81" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">765</span></span>
<span id="cb234-82"><a href="#cb234-82" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828842780381122</span></span>
<span id="cb234-83"><a href="#cb234-83" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">766</span></span>
<span id="cb234-84"><a href="#cb234-84" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833282210197786</span></span>
<span id="cb234-85"><a href="#cb234-85" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">767</span></span>
<span id="cb234-86"><a href="#cb234-86" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.82944064674115</span></span>
<span id="cb234-87"><a href="#cb234-87" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">768</span></span>
<span id="cb234-88"><a href="#cb234-88" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832924358100198</span></span>
<span id="cb234-89"><a href="#cb234-89" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">769</span></span>
<span id="cb234-90"><a href="#cb234-90" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830805294691046</span></span>
<span id="cb234-91"><a href="#cb234-91" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">770</span></span>
<span id="cb234-92"><a href="#cb234-92" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831274836665161</span></span>
<span id="cb234-93"><a href="#cb234-93" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">771</span></span>
<span id="cb234-94"><a href="#cb234-94" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830376397878408</span></span>
<span id="cb234-95"><a href="#cb234-95" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">772</span></span>
<span id="cb234-96"><a href="#cb234-96" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832604789981756</span></span>
<span id="cb234-97"><a href="#cb234-97" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">773</span></span>
<span id="cb234-98"><a href="#cb234-98" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829576028459974</span></span>
<span id="cb234-99"><a href="#cb234-99" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">774</span></span>
<span id="cb234-100"><a href="#cb234-100" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830796112836969</span></span>
<span id="cb234-101"><a href="#cb234-101" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">775</span></span>
<span id="cb234-102"><a href="#cb234-102" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831481002981783</span></span>
<span id="cb234-103"><a href="#cb234-103" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">776</span></span>
<span id="cb234-104"><a href="#cb234-104" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831676908866007</span></span>
<span id="cb234-105"><a href="#cb234-105" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">777</span></span>
<span id="cb234-106"><a href="#cb234-106" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.82931315042137</span></span>
<span id="cb234-107"><a href="#cb234-107" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">778</span></span>
<span id="cb234-108"><a href="#cb234-108" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828951603116439</span></span>
<span id="cb234-109"><a href="#cb234-109" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">779</span></span>
<span id="cb234-110"><a href="#cb234-110" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831139055149746</span></span>
<span id="cb234-111"><a href="#cb234-111" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">780</span></span>
<span id="cb234-112"><a href="#cb234-112" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830316739537019</span></span>
<span id="cb234-113"><a href="#cb234-113" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">781</span></span>
<span id="cb234-114"><a href="#cb234-114" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830458930586156</span></span>
<span id="cb234-115"><a href="#cb234-115" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">782</span></span>
<span id="cb234-116"><a href="#cb234-116" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833230662394588</span></span>
<span id="cb234-117"><a href="#cb234-117" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">783</span></span>
<span id="cb234-118"><a href="#cb234-118" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832973909576033</span></span>
<span id="cb234-119"><a href="#cb234-119" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">784</span></span>
<span id="cb234-120"><a href="#cb234-120" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831423925116023</span></span>
<span id="cb234-121"><a href="#cb234-121" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">785</span></span>
<span id="cb234-122"><a href="#cb234-122" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829803683418786</span></span>
<span id="cb234-123"><a href="#cb234-123" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">786</span></span>
<span id="cb234-124"><a href="#cb234-124" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828531421840785</span></span>
<span id="cb234-125"><a href="#cb234-125" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">787</span></span>
<span id="cb234-126"><a href="#cb234-126" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830345759971399</span></span>
<span id="cb234-127"><a href="#cb234-127" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">788</span></span>
<span id="cb234-128"><a href="#cb234-128" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830471339400124</span></span>
<span id="cb234-129"><a href="#cb234-129" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">789</span></span>
<span id="cb234-130"><a href="#cb234-130" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832798840438387</span></span>
<span id="cb234-131"><a href="#cb234-131" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">790</span></span>
<span id="cb234-132"><a href="#cb234-132" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.83113249780185</span></span>
<span id="cb234-133"><a href="#cb234-133" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">791</span></span>
<span id="cb234-134"><a href="#cb234-134" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.827034393025223</span></span>
<span id="cb234-135"><a href="#cb234-135" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">792</span></span>
<span id="cb234-136"><a href="#cb234-136" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829133703096098</span></span>
<span id="cb234-137"><a href="#cb234-137" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">793</span></span>
<span id="cb234-138"><a href="#cb234-138" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831933812229025</span></span>
<span id="cb234-139"><a href="#cb234-139" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">794</span></span>
<span id="cb234-140"><a href="#cb234-140" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830849224075565</span></span>
<span id="cb234-141"><a href="#cb234-141" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">795</span></span>
<span id="cb234-142"><a href="#cb234-142" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830321144305101</span></span>
<span id="cb234-143"><a href="#cb234-143" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">796</span></span>
<span id="cb234-144"><a href="#cb234-144" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829138641042415</span></span>
<span id="cb234-145"><a href="#cb234-145" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">797</span></span>
<span id="cb234-146"><a href="#cb234-146" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830608786109532</span></span>
<span id="cb234-147"><a href="#cb234-147" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">798</span></span>
<span id="cb234-148"><a href="#cb234-148" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831307623612618</span></span>
<span id="cb234-149"><a href="#cb234-149" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">799</span></span>
<span id="cb234-150"><a href="#cb234-150" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833242600852963</span></span>
<span id="cb234-151"><a href="#cb234-151" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">800</span></span>
<span id="cb234-152"><a href="#cb234-152" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832427578593409</span></span>
<span id="cb234-153"><a href="#cb234-153" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">801</span></span>
<span id="cb234-154"><a href="#cb234-154" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.83096960265283</span></span>
<span id="cb234-155"><a href="#cb234-155" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">802</span></span>
<span id="cb234-156"><a href="#cb234-156" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.8301887673541</span></span>
<span id="cb234-157"><a href="#cb234-157" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">803</span></span>
<span id="cb234-158"><a href="#cb234-158" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.834255445238142</span></span>
<span id="cb234-159"><a href="#cb234-159" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">804</span></span>
<span id="cb234-160"><a href="#cb234-160" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832521588463182</span></span>
<span id="cb234-161"><a href="#cb234-161" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">805</span></span>
<span id="cb234-162"><a href="#cb234-162" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831715300054422</span></span>
<span id="cb234-163"><a href="#cb234-163" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">806</span></span>
<span id="cb234-164"><a href="#cb234-164" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831639594906041</span></span>
<span id="cb234-165"><a href="#cb234-165" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">807</span></span>
<span id="cb234-166"><a href="#cb234-166" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.83115606975791</span></span>
<span id="cb234-167"><a href="#cb234-167" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">808</span></span>
<span id="cb234-168"><a href="#cb234-168" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833148579276595</span></span>
<span id="cb234-169"><a href="#cb234-169" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">809</span></span>
<span id="cb234-170"><a href="#cb234-170" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831414942555648</span></span>
<span id="cb234-171"><a href="#cb234-171" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">810</span></span>
<span id="cb234-172"><a href="#cb234-172" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833719784150672</span></span>
<span id="cb234-173"><a href="#cb234-173" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">811</span></span>
<span id="cb234-174"><a href="#cb234-174" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828375723575394</span></span>
<span id="cb234-175"><a href="#cb234-175" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">812</span></span>
<span id="cb234-176"><a href="#cb234-176" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830543845828127</span></span>
<span id="cb234-177"><a href="#cb234-177" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">813</span></span>
<span id="cb234-178"><a href="#cb234-178" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832240311900002</span></span>
<span id="cb234-179"><a href="#cb234-179" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">814</span></span>
<span id="cb234-180"><a href="#cb234-180" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831434839902126</span></span>
<span id="cb234-181"><a href="#cb234-181" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">815</span></span>
<span id="cb234-182"><a href="#cb234-182" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828803556504407</span></span>
<span id="cb234-183"><a href="#cb234-183" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">816</span></span>
<span id="cb234-184"><a href="#cb234-184" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829547281428623</span></span>
<span id="cb234-185"><a href="#cb234-185" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">817</span></span>
<span id="cb234-186"><a href="#cb234-186" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831058937941818</span></span>
<span id="cb234-187"><a href="#cb234-187" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">818</span></span>
<span id="cb234-188"><a href="#cb234-188" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.82938891796316</span></span>
<span id="cb234-189"><a href="#cb234-189" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">819</span></span>
<span id="cb234-190"><a href="#cb234-190" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830405198798365</span></span>
<span id="cb234-191"><a href="#cb234-191" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">820</span></span>
<span id="cb234-192"><a href="#cb234-192" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832115866093099</span></span>
<span id="cb234-193"><a href="#cb234-193" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">821</span></span>
<span id="cb234-194"><a href="#cb234-194" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830412735051787</span></span>
<span id="cb234-195"><a href="#cb234-195" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">822</span></span>
<span id="cb234-196"><a href="#cb234-196" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828572195678903</span></span>
<span id="cb234-197"><a href="#cb234-197" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">823</span></span>
<span id="cb234-198"><a href="#cb234-198" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830266787825573</span></span>
<span id="cb234-199"><a href="#cb234-199" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">824</span></span>
<span id="cb234-200"><a href="#cb234-200" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.83184289974954</span></span>
<span id="cb234-201"><a href="#cb234-201" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">825</span></span>
<span id="cb234-202"><a href="#cb234-202" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829420782829894</span></span>
<span id="cb234-203"><a href="#cb234-203" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">826</span></span>
<span id="cb234-204"><a href="#cb234-204" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831359754548764</span></span>
<span id="cb234-205"><a href="#cb234-205" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">827</span></span>
<span id="cb234-206"><a href="#cb234-206" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830368557576751</span></span>
<span id="cb234-207"><a href="#cb234-207" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">828</span></span>
<span id="cb234-208"><a href="#cb234-208" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832429361513429</span></span>
<span id="cb234-209"><a href="#cb234-209" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">829</span></span>
<span id="cb234-210"><a href="#cb234-210" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829330567671406</span></span>
<span id="cb234-211"><a href="#cb234-211" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">830</span></span>
<span id="cb234-212"><a href="#cb234-212" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833664185213611</span></span>
<span id="cb234-213"><a href="#cb234-213" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">831</span></span>
<span id="cb234-214"><a href="#cb234-214" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829605680296404</span></span>
<span id="cb234-215"><a href="#cb234-215" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">832</span></span>
<span id="cb234-216"><a href="#cb234-216" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833311778486311</span></span>
<span id="cb234-217"><a href="#cb234-217" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">833</span></span>
<span id="cb234-218"><a href="#cb234-218" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830353478426326</span></span>
<span id="cb234-219"><a href="#cb234-219" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">834</span></span>
<span id="cb234-220"><a href="#cb234-220" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.82977377053556</span></span>
<span id="cb234-221"><a href="#cb234-221" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">835</span></span>
<span id="cb234-222"><a href="#cb234-222" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829937703219876</span></span>
<span id="cb234-223"><a href="#cb234-223" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">836</span></span>
<span id="cb234-224"><a href="#cb234-224" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831846806163151</span></span>
<span id="cb234-225"><a href="#cb234-225" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">837</span></span>
<span id="cb234-226"><a href="#cb234-226" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829895075127843</span></span>
<span id="cb234-227"><a href="#cb234-227" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">838</span></span>
<span id="cb234-228"><a href="#cb234-228" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833262019160109</span></span>
<span id="cb234-229"><a href="#cb234-229" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">839</span></span>
<span id="cb234-230"><a href="#cb234-230" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829433660783203</span></span>
<span id="cb234-231"><a href="#cb234-231" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">840</span></span>
<span id="cb234-232"><a href="#cb234-232" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.827531432547631</span></span>
<span id="cb234-233"><a href="#cb234-233" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">841</span></span>
<span id="cb234-234"><a href="#cb234-234" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.82975712679373</span></span>
<span id="cb234-235"><a href="#cb234-235" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">842</span></span>
<span id="cb234-236"><a href="#cb234-236" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832414617979685</span></span>
<span id="cb234-237"><a href="#cb234-237" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">843</span></span>
<span id="cb234-238"><a href="#cb234-238" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830781131471392</span></span>
<span id="cb234-239"><a href="#cb234-239" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">844</span></span>
<span id="cb234-240"><a href="#cb234-240" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829109261064835</span></span>
<span id="cb234-241"><a href="#cb234-241" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">845</span></span>
<span id="cb234-242"><a href="#cb234-242" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832406223647478</span></span>
<span id="cb234-243"><a href="#cb234-243" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">846</span></span>
<span id="cb234-244"><a href="#cb234-244" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.834708366156922</span></span>
<span id="cb234-245"><a href="#cb234-245" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">847</span></span>
<span id="cb234-246"><a href="#cb234-246" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833191760455706</span></span>
<span id="cb234-247"><a href="#cb234-247" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">848</span></span>
<span id="cb234-248"><a href="#cb234-248" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831812936634274</span></span>
<span id="cb234-249"><a href="#cb234-249" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">849</span></span>
<span id="cb234-250"><a href="#cb234-250" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832387913503154</span></span>
<span id="cb234-251"><a href="#cb234-251" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">850</span></span>
<span id="cb234-252"><a href="#cb234-252" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833075377352126</span></span>
<span id="cb234-253"><a href="#cb234-253" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">851</span></span>
<span id="cb234-254"><a href="#cb234-254" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830123177762137</span></span>
<span id="cb234-255"><a href="#cb234-255" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">852</span></span>
<span id="cb234-256"><a href="#cb234-256" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831841299216412</span></span>
<span id="cb234-257"><a href="#cb234-257" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">853</span></span>
<span id="cb234-258"><a href="#cb234-258" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831365701551992</span></span>
<span id="cb234-259"><a href="#cb234-259" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">854</span></span>
<span id="cb234-260"><a href="#cb234-260" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830989278187555</span></span>
<span id="cb234-261"><a href="#cb234-261" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">855</span></span>
<span id="cb234-262"><a href="#cb234-262" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.834752901702268</span></span>
<span id="cb234-263"><a href="#cb234-263" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">856</span></span>
<span id="cb234-264"><a href="#cb234-264" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832148011460522</span></span>
<span id="cb234-265"><a href="#cb234-265" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">857</span></span>
<span id="cb234-266"><a href="#cb234-266" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830067314893585</span></span>
<span id="cb234-267"><a href="#cb234-267" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">858</span></span>
<span id="cb234-268"><a href="#cb234-268" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.83078531914217</span></span>
<span id="cb234-269"><a href="#cb234-269" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">859</span></span>
<span id="cb234-270"><a href="#cb234-270" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830479327296697</span></span>
<span id="cb234-271"><a href="#cb234-271" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">860</span></span>
<span id="cb234-272"><a href="#cb234-272" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.834880676239004</span></span>
<span id="cb234-273"><a href="#cb234-273" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">861</span></span>
<span id="cb234-274"><a href="#cb234-274" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833506472321838</span></span>
<span id="cb234-275"><a href="#cb234-275" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">862</span></span>
<span id="cb234-276"><a href="#cb234-276" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830843082210954</span></span>
<span id="cb234-277"><a href="#cb234-277" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">863</span></span>
<span id="cb234-278"><a href="#cb234-278" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830132630677842</span></span>
<span id="cb234-279"><a href="#cb234-279" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">864</span></span>
<span id="cb234-280"><a href="#cb234-280" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828704486734575</span></span>
<span id="cb234-281"><a href="#cb234-281" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">865</span></span>
<span id="cb234-282"><a href="#cb234-282" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.8293732367072</span></span>
<span id="cb234-283"><a href="#cb234-283" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">866</span></span>
<span id="cb234-284"><a href="#cb234-284" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829996086927068</span></span>
<span id="cb234-285"><a href="#cb234-285" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">867</span></span>
<span id="cb234-286"><a href="#cb234-286" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.83288312812145</span></span>
<span id="cb234-287"><a href="#cb234-287" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">868</span></span>
<span id="cb234-288"><a href="#cb234-288" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831467621740344</span></span>
<span id="cb234-289"><a href="#cb234-289" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">869</span></span>
<span id="cb234-290"><a href="#cb234-290" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829259249144337</span></span>
<span id="cb234-291"><a href="#cb234-291" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">870</span></span>
<span id="cb234-292"><a href="#cb234-292" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830770774516278</span></span>
<span id="cb234-293"><a href="#cb234-293" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">871</span></span>
<span id="cb234-294"><a href="#cb234-294" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828837075909044</span></span>
<span id="cb234-295"><a href="#cb234-295" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">872</span></span>
<span id="cb234-296"><a href="#cb234-296" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829758111980732</span></span>
<span id="cb234-297"><a href="#cb234-297" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">873</span></span>
<span id="cb234-298"><a href="#cb234-298" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829557855443734</span></span>
<span id="cb234-299"><a href="#cb234-299" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">874</span></span>
<span id="cb234-300"><a href="#cb234-300" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830523982844196</span></span>
<span id="cb234-301"><a href="#cb234-301" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">875</span></span>
<span id="cb234-302"><a href="#cb234-302" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831009886895258</span></span>
<span id="cb234-303"><a href="#cb234-303" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">876</span></span>
<span id="cb234-304"><a href="#cb234-304" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.82944013294738</span></span>
<span id="cb234-305"><a href="#cb234-305" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">877</span></span>
<span id="cb234-306"><a href="#cb234-306" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832028294836151</span></span>
<span id="cb234-307"><a href="#cb234-307" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">878</span></span>
<span id="cb234-308"><a href="#cb234-308" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.833992472427127</span></span>
<span id="cb234-309"><a href="#cb234-309" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">879</span></span>
<span id="cb234-310"><a href="#cb234-310" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828809446103142</span></span>
<span id="cb234-311"><a href="#cb234-311" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">880</span></span>
<span id="cb234-312"><a href="#cb234-312" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.827440566241794</span></span>
<span id="cb234-313"><a href="#cb234-313" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">881</span></span>
<span id="cb234-314"><a href="#cb234-314" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.83157952544884</span></span>
<span id="cb234-315"><a href="#cb234-315" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">882</span></span>
<span id="cb234-316"><a href="#cb234-316" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829294634223024</span></span>
<span id="cb234-317"><a href="#cb234-317" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">883</span></span>
<span id="cb234-318"><a href="#cb234-318" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832394559788004</span></span>
<span id="cb234-319"><a href="#cb234-319" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">884</span></span>
<span id="cb234-320"><a href="#cb234-320" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831141692432181</span></span>
<span id="cb234-321"><a href="#cb234-321" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">885</span></span>
<span id="cb234-322"><a href="#cb234-322" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831071687513164</span></span>
<span id="cb234-323"><a href="#cb234-323" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">886</span></span>
<span id="cb234-324"><a href="#cb234-324" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828715571246103</span></span>
<span id="cb234-325"><a href="#cb234-325" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">887</span></span>
<span id="cb234-326"><a href="#cb234-326" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829535263164816</span></span>
<span id="cb234-327"><a href="#cb234-327" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">888</span></span>
<span id="cb234-328"><a href="#cb234-328" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831319756325194</span></span>
<span id="cb234-329"><a href="#cb234-329" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">889</span></span>
<span id="cb234-330"><a href="#cb234-330" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831550952889957</span></span>
<span id="cb234-331"><a href="#cb234-331" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">890</span></span>
<span id="cb234-332"><a href="#cb234-332" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829990162602387</span></span>
<span id="cb234-333"><a href="#cb234-333" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">891</span></span>
<span id="cb234-334"><a href="#cb234-334" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.834388880202844</span></span>
<span id="cb234-335"><a href="#cb234-335" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">892</span></span>
<span id="cb234-336"><a href="#cb234-336" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831444356778861</span></span>
<span id="cb234-337"><a href="#cb234-337" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">893</span></span>
<span id="cb234-338"><a href="#cb234-338" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.829154145538292</span></span>
<span id="cb234-339"><a href="#cb234-339" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">894</span></span>
<span id="cb234-340"><a href="#cb234-340" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831118924732515</span></span>
<span id="cb234-341"><a href="#cb234-341" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">895</span></span>
<span id="cb234-342"><a href="#cb234-342" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832741630646768</span></span>
<span id="cb234-343"><a href="#cb234-343" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">896</span></span>
<span id="cb234-344"><a href="#cb234-344" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828300969146387</span></span>
<span id="cb234-345"><a href="#cb234-345" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">897</span></span>
<span id="cb234-346"><a href="#cb234-346" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.831320866320787</span></span>
<span id="cb234-347"><a href="#cb234-347" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">898</span></span>
<span id="cb234-348"><a href="#cb234-348" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828244750811946</span></span>
<span id="cb234-349"><a href="#cb234-349" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">899</span></span>
<span id="cb234-350"><a href="#cb234-350" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.832772387332717</span></span>
<span id="cb234-351"><a href="#cb234-351" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">900</span></span>
<span id="cb234-352"><a href="#cb234-352" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828538098204589</span></span>
<span id="cb234-353"><a href="#cb234-353" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">901</span></span>
<span id="cb234-354"><a href="#cb234-354" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.82750095108753</span></span>
<span id="cb234-355"><a href="#cb234-355" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">902</span></span>
<span id="cb234-356"><a href="#cb234-356" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.828826070773062</span></span>
<span id="cb234-357"><a href="#cb234-357" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">903</span></span>
<span id="cb234-358"><a href="#cb234-358" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830187793236362</span></span>
<span id="cb234-359"><a href="#cb234-359" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">904</span></span>
<span id="cb234-360"><a href="#cb234-360" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.83278488113049</span></span>
<span id="cb234-361"><a href="#cb234-361" aria-hidden="true" tabindex="-1"></a>Bandwidth<span class="sc">:</span> <span class="dv">905</span></span>
<span id="cb234-362"><a href="#cb234-362" aria-hidden="true" tabindex="-1"></a>R2 of Local Model<span class="sc">:</span> <span class="fl">0.830157433907511</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Base on the output, we will pick the best bandwidth that has the largest R2 of Local Model. The best bandwidth would be 860 with a R2 of 0.834880676239004.</p>
</section>
<section id="calibrating-geographical-random-forest-model" class="level2" data-number="9.6">
<h2 data-number="9.6" class="anchored" data-anchor-id="calibrating-geographical-random-forest-model"><span class="header-section-number">9.6</span> Calibrating Geographical Random Forest Model</h2>
<p>We will use grf() from the SpatialML package to calibrate our GRF Model. It takes in the formula which is the same as the non-spatial regression. We will use the bandwidth calculated from the above section and generate base on ntree =30.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive <span class="ot">&lt;-</span> <span class="fu">grf</span>(PRICE <span class="sc">~</span> AREA_SQM <span class="sc">+</span> REMAINING_LEASE <span class="sc">+</span> Stry_Or <span class="sc">+</span> Improvd <span class="sc">+</span> DBSS <span class="sc">+</span> Standrd <span class="sc">+</span> Model.A <span class="sc">+</span> PrmmApr <span class="sc">+</span> Adjndfl <span class="sc">+</span> MdlA.Ms <span class="sc">+</span> Type.S2 <span class="sc">+</span> Imprv.M <span class="sc">+</span> PrmmApL <span class="sc">+</span> PROX_CBD <span class="sc">+</span> PROX_CLUBS <span class="sc">+</span> PROX_ELDERCARE <span class="sc">+</span> PROX_FAM <span class="sc">+</span> PROX_MRT <span class="sc">+</span>PROX_HAWKER <span class="sc">+</span> PROX_PHARMACY <span class="sc">+</span>PROX_PARK<span class="sc">+</span>PROX_MALL <span class="sc">+</span> PROX_SPRMKT <span class="sc">+</span> PROX_GOODP <span class="sc">+</span> NUM_KNDRGTN <span class="sc">+</span> NUM_CHILDCARE <span class="sc">+</span> NUM_BUS_STOP <span class="sc">+</span> NUM_PRISCH <span class="sc">+</span> NUM_SECSCH,</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dframe=</span>train_data_nogeo, </span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">bw=</span> <span class="dv">860</span>,</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">ntree =</span> <span class="dv">30</span>,</span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">kernel=</span><span class="st">"adaptive"</span>,</span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">coords=</span>coords_train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s save the model output below:</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_adaptive, <span class="st">"data/model/grf_adaptive_30.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/grf_adaptive_30.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(gwRF_adaptive<span class="sc">$</span>Local.Variable.Importance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 14,508
Columns: 29
$ AREA_SQM        &lt;dbl&gt; 2.424581e+12, 1.067095e+12, 2.124910e+12, 7.837314e+11…
$ REMAINING_LEASE &lt;dbl&gt; 5.968755e+12, 1.089890e+13, 9.198546e+12, 1.086368e+13…
$ Stry_Or         &lt;dbl&gt; 1.667894e+12, 1.954235e+12, 1.815572e+12, 2.209834e+12…
$ Improvd         &lt;dbl&gt; 46371370090, 46000691389, 199742435598, 48055723839, 7…
$ DBSS            &lt;dbl&gt; 7.994889e+11, 1.986315e+12, 1.801003e+12, 3.074813e+12…
$ Standrd         &lt;dbl&gt; 9821725666, 56537787184, 15127326668, 13405301561, 631…
$ Model.A         &lt;dbl&gt; 173030452009, 120118885998, 130623963170, 64483614844,…
$ PrmmApr         &lt;dbl&gt; 3521273825, 1407159318, 4885296574, 1080998429, 261446…
$ Adjndfl         &lt;dbl&gt; 28010101108, 9842577858, 25925330231, 5026815733, 5281…
$ MdlA.Ms         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 238319006725, 2…
$ Type.S2         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ Imprv.M         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ PrmmApL         &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
$ PROX_CBD        &lt;dbl&gt; 3.143436e+12, 1.637833e+12, 2.894628e+12, 1.109727e+12…
$ PROX_CLUBS      &lt;dbl&gt; 264741138668, 256459298333, 317281249569, 368099992286…
$ PROX_ELDERCARE  &lt;dbl&gt; 2.720343e+12, 4.122348e+11, 8.026449e+11, 6.336642e+11…
$ PROX_FAM        &lt;dbl&gt; 702241926259, 563650762125, 317687788090, 366672142814…
$ PROX_MRT        &lt;dbl&gt; 443333732342, 311850538700, 562893756604, 534168623064…
$ PROX_HAWKER     &lt;dbl&gt; 1.412642e+12, 9.811855e+11, 6.902099e+11, 1.284863e+12…
$ PROX_PHARMACY   &lt;dbl&gt; 247787721115, 291240092756, 413695349865, 302242460583…
$ PROX_PARK       &lt;dbl&gt; 396585553907, 299799741177, 465855477858, 317239418707…
$ PROX_MALL       &lt;dbl&gt; 401899080285, 475189291360, 333830540213, 396914155503…
$ PROX_SPRMKT     &lt;dbl&gt; 210055129383, 645232312470, 429357319993, 362962573963…
$ PROX_GOODP      &lt;dbl&gt; 4.228778e+11, 1.239573e+12, 9.654273e+11, 1.172245e+12…
$ NUM_KNDRGTN     &lt;dbl&gt; 1.085026e+11, 1.945946e+12, 7.812492e+11, 1.678249e+12…
$ NUM_CHILDCARE   &lt;dbl&gt; 377010029537, 120213318416, 182572370153, 166189406726…
$ NUM_BUS_STOP    &lt;dbl&gt; 126496825575, 199449729515, 165931917136, 299260796894…
$ NUM_PRISCH      &lt;dbl&gt; 2.100533e+11, 3.394678e+11, 7.286130e+11, 3.729309e+11…
$ NUM_SECSCH      &lt;dbl&gt; 43167881817, 89902757844, 148178405985, 34834034730, 6…</code></pre>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>gwRF_adaptive<span class="sc">$</span>Global.Model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ranger result

Call:
 ranger(PRICE ~ AREA_SQM + REMAINING_LEASE + Stry_Or + Improvd +      DBSS + Standrd + Model.A + PrmmApr + Adjndfl + MdlA.Ms +      Type.S2 + Imprv.M + PrmmApL + PROX_CBD + PROX_CLUBS + PROX_ELDERCARE +      PROX_FAM + PROX_MRT + PROX_HAWKER + PROX_PHARMACY + PROX_PARK +      PROX_MALL + PROX_SPRMKT + PROX_GOODP + NUM_KNDRGTN + NUM_CHILDCARE +      NUM_BUS_STOP + NUM_PRISCH + NUM_SECSCH, data = train_data_nogeo,      num.trees = 30, mtry = 9, importance = "impurity", num.threads = NULL) 

Type:                             Regression 
Number of trees:                  30 
Sample size:                      14508 
Number of independent variables:  29 
Mtry:                             9 
Target node size:                 5 
Variable importance mode:         impurity 
Splitrule:                        variance 
OOB prediction error (MSE):       1849063516 
R squared (OOB):                  0.9133974 </code></pre>
</div>
</div>
</section>
<section id="predicting-by-using-test-data" class="level2" data-number="9.7">
<h2 data-number="9.7" class="anchored" data-anchor-id="predicting-by-using-test-data"><span class="header-section-number">9.7</span> Predicting by using test data</h2>
<section id="preparing-the-test-data" class="level3" data-number="9.7.1">
<h3 data-number="9.7.1" class="anchored" data-anchor-id="preparing-the-test-data"><span class="header-section-number">9.7.1</span> Preparing the test data</h3>
<p>The code chunk below will be used to combine the test data with its corresponding coordinates data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data, coords_test) <span class="sc">%&gt;%</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_drop_geometry</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="predicting-with-test-data" class="level3" data-number="9.7.2">
<h3 data-number="9.7.2" class="anchored" data-anchor-id="predicting-with-test-data"><span class="header-section-number">9.7.2</span> Predicting with test data</h3>
<p>Next, predict.grf() of SpatialML package will be used to predict the resale value by using the test data and gwRF_adaptive model calibrated earlier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>gwRF_pred <span class="ot">&lt;-</span> <span class="fu">predict.grf</span>(gwRF_adaptive, </span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>                           test_data, </span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">x.var.name=</span><span class="st">"X"</span>,</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">y.var.name=</span><span class="st">"Y"</span>, </span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">local.w=</span><span class="dv">1</span>,</span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a>                           <span class="at">global.w=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We should always save our output into rds since these computations take a really long time.</p>
<div class="cell">
<details>
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(gwRF_pred, <span class="st">"data/model/GRF_pred.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="converting-predicted-output-into-a-data-frame" class="level3" data-number="9.7.3">
<h3 data-number="9.7.3" class="anchored" data-anchor-id="converting-predicted-output-into-a-data-frame"><span class="header-section-number">9.7.3</span> Converting predicted output into a data frame</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reads the data in and makes it a dataframe</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>GRF_pred_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">read_rds</span>(<span class="st">"data/model/GRF_pred.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Then, we will use cbind() to append the predicted values onto the test data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a>test_data_p <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data, GRF_pred_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(test_data_p, <span class="st">"data/model/test_data_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb248"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a>test_data_p <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data/model/test_data_p.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculating-root-mean-square-error" class="level3" data-number="9.7.4">
<h3 data-number="9.7.4" class="anchored" data-anchor-id="calculating-root-mean-square-error"><span class="header-section-number">9.7.4</span> Calculating Root Mean Square Error</h3>
<p>The root mean square error (RMSE) allows us to measure how far predicted values are from observed values in a regression analysis. In the code chunk below, rmse() of Metrics package is used to compute the RMSE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(test_data_p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 998
Columns: 50
$ PRICE                                 &lt;dbl&gt; 682888.0, 695000.0, 658888.0, 74…
$ month                                 &lt;date&gt; 2023-01-01, 2023-01-01, 2023-01…
$ AREA_SQM                              &lt;dbl&gt; 123, 123, 119, 119, 135, 135, 11…
$ REMAINING_LEASE                       &lt;dbl&gt; 53.58, 53.58, 55.42, 54.92, 58.4…
$ Stry_Or                               &lt;dbl&gt; 6, 2, 4, 8, 5, 1, 2, 5, 4, 7, 7,…
$ Improvd                               &lt;dbl&gt; 0, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1,…
$ NwGnrtn                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ DBSS                                  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Standrd                               &lt;dbl&gt; 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Aprtmnt                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Simplfd                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Model.A                               &lt;dbl&gt; 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0,…
$ PrmmApr                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Adjndfl                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ MdlA.Ms                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Maisntt                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Type.S1                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Type.S2                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ ModelA2                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Terrace                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ Imprv.M                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ PrmmMsn                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ MltGnrt                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ PrmmApL                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ X2.room                               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ X3Gen                                 &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ PROX_CBD                              &lt;dbl&gt; 8625.861, 8625.861, 8139.329, 88…
$ PROX_BUS                              &lt;dbl&gt; 178.81652, 178.81652, 118.76102,…
$ PROX_CLUBS                            &lt;dbl&gt; 578.73029, 578.73029, 265.15993,…
$ PROX_ELDERCARE                        &lt;dbl&gt; 211.9637, 211.9637, 367.6850, 35…
$ PROX_FAM                              &lt;dbl&gt; 940.0572, 940.0572, 612.9699, 31…
$ PROX_MRT                              &lt;dbl&gt; 573.2417, 573.2417, 1065.8815, 3…
$ PROX_HAWKER                           &lt;dbl&gt; 331.2628, 331.2628, 143.0536, 37…
$ PROX_KINDERGARTENS                    &lt;dbl&gt; 188.26098, 188.26098, 518.63595,…
$ PROX_PHARMACY                         &lt;dbl&gt; 488.5421, 488.5421, 1152.5507, 5…
$ PROX_PARK                             &lt;dbl&gt; 554.3174, 554.3174, 537.1188, 39…
$ PROX_MALL                             &lt;dbl&gt; 490.9497, 490.9497, 1145.3444, 5…
$ PROX_SPRMKT                           &lt;dbl&gt; 246.50070, 246.50070, 504.07157,…
$ PROX_CHILDCARE                        &lt;dbl&gt; 1.580294e+02, 1.580294e+02, 3.27…
$ PROX_PRISCH                           &lt;dbl&gt; 585.34956, 585.34956, 240.18714,…
$ PROX_GOODP                            &lt;dbl&gt; 5325.218, 5325.218, 4880.120, 56…
$ PROX_SECSCH                           &lt;dbl&gt; 438.0324, 438.0324, 586.3205, 25…
$ NUM_KNDRGTN                           &lt;dbl&gt; 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 2,…
$ NUM_CHILDCARE                         &lt;dbl&gt; 6, 6, 1, 4, 2, 2, 3, 5, 5, 4, 8,…
$ NUM_BUS_STOP                          &lt;dbl&gt; 6, 6, 7, 6, 6, 6, 6, 8, 10, 6, 8…
$ NUM_PRISCH                            &lt;dbl&gt; 3, 3, 2, 3, 3, 3, 2, 2, 2, 2, 3,…
$ NUM_SECSCH                            &lt;dbl&gt; 2, 2, 1, 2, 2, 2, 3, 2, 2, 2, 3,…
$ X                                     &lt;dbl&gt; 29383.53, 29383.53, 30446.32, 30…
$ Y                                     &lt;dbl&gt; 38640.51, 38640.51, 38170.74, 38…
$ `read_rds("data/model/GRF_pred.rds")` &lt;dbl&gt; 694987.6, 674191.5, 670978.4, 72…</code></pre>
</div>
</div>
<p>We notice that the column name is stated <code>read_rds("data/model/GRF_pred.rds")</code>, we will change the name accordingly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a>test_data_p <span class="ot">&lt;-</span> test_data_p <span class="sc">%&gt;%</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">GRF_pred =</span> <span class="st">`</span><span class="at">read_rds("data/model/GRF_pred.rds")</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>rmse_grf<span class="ot">&lt;-</span> <span class="fu">rmse</span>(test_data_p<span class="sc">$</span>PRICE, </span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a>     test_data_p<span class="sc">$</span>GRF_pred)</span>
<span id="cb252-3"><a href="#cb252-3" aria-hidden="true" tabindex="-1"></a>rmse_grf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56235.78</code></pre>
</div>
</div>
<p>We notice from the rmse is 56235.78, which is lower than the OLS rmse. Furthermore, Rsquare of the gwRF is 0.91 which is much higher than the OLS model. Hence, this is a better model in terms if its prediction accuracy.</p>
</section>
<section id="visualising-the-predicted-values" class="level3" data-number="9.7.5">
<h3 data-number="9.7.5" class="anchored" data-anchor-id="visualising-the-predicted-values"><span class="header-section-number">9.7.5</span> Visualising the predicted values</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test_data_p,</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> GRF_pred,</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> PRICE)) <span class="sc">+</span></span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-175-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="conclusion" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Conclusion</h1>
<p>Lastly, we were task to compare the performance of the conventional OLS method versus the geographical weighted methods.</p>
<section id="differences-between-the-two-models" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="differences-between-the-two-models"><span class="header-section-number">10.1</span> Differences between the two models</h2>
<ol type="1">
<li>OLS does not take into account the spatial autocorrelation whereas GRF does.</li>
<li>Conventional OLS is generally good for exploratory data analysis but even so, more needs to be done to improve the model if it is meant to be used for prediction</li>
</ol>
<p>We will compare the two models base on RMSE and on the visual plot.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">Non-Spatial Multiple linear Regression</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">Geographical Random Forest Model</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a>rmse_lm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 87822.93</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>test_data_lm <span class="ot">&lt;-</span> <span class="fu">cbind</span>(test_data, lm_predicted_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test_data_lm,</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> lm_predicted_value,</span>
<span id="cb258-3"><a href="#cb258-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> PRICE)) <span class="sc">+</span></span>
<span id="cb258-4"><a href="#cb258-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb258-5"><a href="#cb258-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">col =</span> <span class="st">"Red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-178-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a>rmse_grf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 56235.78</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> test_data_p,</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> GRF_pred,</span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> PRICE)) <span class="sc">+</span></span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">col =</span> <span class="st">"Red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-Home_Ex03_files/figure-html/unnamed-chunk-180-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="predictive-power" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="predictive-power"><span class="header-section-number">10.2</span> Predictive Power</h2>
<p>By comparing the two models, we can see the RMSE for GRF, 56235.78, is lower than the RMSE for non-spatial regression, 87822.93. This suggest that the GRF Model is better at predicting the resale price.</p>
<p>Furthermore, we also notice that the points scattered in the GRF Model are clustered around the red line more than the non-spatial regression.</p>
</section>
<section id="limitations-of-analysis" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="limitations-of-analysis"><span class="header-section-number">10.3</span> Limitations of Analysis</h2>
<ol type="1">
<li>One obvious limitation is the “sub-optimal” bandwidth generated for the GRF Model. This is due to the lack of computational power our devices have.</li>
<li>Second is the number of trees that can be generated. Again for the same reason, I was only able to do ntree = 30. Having more trees may have better predictive power.</li>
</ol>
</section>
<section id="possible-improvements-to-the-model" class="level2" data-number="10.4">
<h2 data-number="10.4" class="anchored" data-anchor-id="possible-improvements-to-the-model"><span class="header-section-number">10.4</span> Possible Improvements to the model</h2>
<ol type="1">
<li>One way to improve the model could be the use of interactive variables.</li>
</ol>
<p>Interactive variables helps to showcase the combined effects between two variables. For example, story_ordinal and NUM of primary school as an interactive variable. The intuition behind this is that primary schools generally contribute to higher noise-pollution and the higher the story level, the better as it can reduce the amount of noise that reaches the apartment. Such combined effects may improve the predictive power the model have.</p>
<p>Another example could be PROX_Parks and Story_Order. The closer one is to parks may signify better views. Higher story may allow residents to have better views and thus raise the price of the apartment. Again this is a useful variable to consider in our modelling.</p>
<ol start="2" type="1">
<li>Removing outliers</li>
</ol>
<p>While the regression helps us explain more than 90% of the variation in the Resale Price, there may be other reasons not captured affect the price. This could include sellers recent renovation of apartment, internal problems of the apartment and many others. Removing outliers may better fit the regression and reduce the prediction error.</p>
<p>However, outliers may have significant effect on the regression and may hold important information about the resale price. Hence, if the goal is to form a regression that is able to predict resale prices approximately, removing outliers in the training data may improve the model.</p>
</section>
</section>
<section id="references" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> References</h1>
<ul>
<li><a href="https://is415-msty.netlify.app/posts/2021-10-25-take-home-exercise-3/">Megan’s work</a></li>
</ul>
<p>Much was referenced to Megan’s work on how to wrangle the data. Her work revolves around create hedonic model and it is a good read to understand how she goes through her assignment.</p>
<ul>
<li><a href="https://is415-gaa-tskam.netlify.app/in-class_ex/in-class_ex09/in-class_ex09_gwml">In-class Exercise 9</a></li>
</ul>
<p>Prof Kam taught us several techniques on how to create the non-spatial regression as well as doing up the GRF modelling.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>